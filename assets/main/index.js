window.__require=function e(t,n,i){function o(a,s){if(!n[a]){if(!t[a]){var c=a.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(r)return r(c,!0);throw new Error("Cannot find module '"+a+"'")}a=c}var d=n[a]={exports:{}};t[a][0].call(d.exports,function(e){return o(t[a][1][e]||e)},d,d.exports,e,t,n,i)}return n[a].exports}for(var r="function"==typeof __require&&__require,a=0;a<i.length;a++)o(i[a]);return o}({AIMove:[function(e,t){"use strict";cc._RF.push(t,"d59f1DK8x1Af58Qru4Hz9y/","AIMove"),cc.Class({extends:cc.Component,makeDecision:function(e,t){var n,i=-1e4;for(var o in t.suggestMoves){var r=t.suggestMoves[o],a=0;a+=this.computeAttackPoint(r.horse,t,e),a+=this.computeDangerPoint(r.horse,t,e),a+=this.computeGoalPoint(r.horse,t,e),a+=this.computeRevengePoint(r.horse,t,e),cc.log("Horse of player: "+t.id+" at loc: ("+r.horse.currentPlace.location.x+", "+r.horse.currentPlace.location.y+") has point: "+a),i<a&&(i=a,n=r)}return n},computeAttackPoint:function(e,t){t.getDiceFaceNumber()[0];var n=e.currentPlace;if(n.placeType==ddt.PlaceType.Fame)return 0;if(n.placeType==ddt.PlaceType.Out&&n.areaType==t.id)return 0;if(n.placeType==ddt.PlaceType.Stable)return t.in.horse&&t.in.horse.owner!=t?60:0;for(var i=null,o=0,r=n;;){if(o++,i=(r=r.nextPlaceHoder).horse){i!=e&&i.owner!=e.owner||(i=null,o=0);break}if(o>100)break}if(0==o)return 0;if(o<7)return 18*Math.random()+30;var a=o-6;return 30/Math.sqrt(a)},computeDangerPoint:function(e,t){t.getDiceFaceNumber()[0];var n=e.currentPlace;if(n.placeType==ddt.PlaceType.Fame)return 0;if(n.placeType==ddt.PlaceType.Stable)return 0;for(var i,o=n,r=0;;){if(r++,i=(o=o.prevPlace).horse){(i==e||i.owner==e.owner||i.placeType==ddt.PlaceType.Out&&i.areaType==i.owner.id)&&(i=null,r=0);break}if(r>100)break}if(0==r)return 0;if(r<7)return 30;var a=r-6;return a<16?0:-30*a/13+30+30/13},computeGoalPoint:function(e,t){var n=0;n+=t.getDiceFaceNumber()[0];var i=e.currentPlace;if(i.placeType==ddt.PlaceType.Stable)return 0;if(i.placeType==ddt.PlaceType.Fame){if(n==t.tower.length)return 100;if(t.tower[n-1],(r=t.tower[n]).horse)return 100;var o=t.tower.indexOf(i);if(o>0&&t.tower[o].horse)return 12.5}i.placeType,ddt.PlaceType.Out;for(var r=i,a=0;a<n;a++)r=r.nextPlaceHoder;if(r.placeType==ddt.PlaceType.Out&&r.areaType==t.id)return 80;var s=0;for(r=i;;){if(null==(r=r.nextPlaceHoder))return 0;if(s++,r.placeType==ddt.PlaceType.Out&&r.areaType==t.id)break;if(s>100)break}var c=s-n;return c<7?50:c<13?20*Math.random()+10:0},computeRevengePoint:function(){return 0}}),cc._RF.pop()},{}],AnimHelper:[function(e,t){"use strict";cc._RF.push(t,"de10aqTSOdA95uyuuLk3/se","AnimHelper"),t.exports=function(){return{createHorseAnimation:function(e,t,n){AssetHelper.createHorseAnimClip(e,t,n)}}},cc._RF.pop()},{}],AssetHelper:[function(e,t){"use strict";cc._RF.push(t,"f15dc9NsMlKEo0aRIxfbzuR","AssetHelper");var n,i,o,r,a,s,c,l=e("async"),d=(n=null,i=null,o=null,r=null,a=null,s=null,c=null,{init:function(){cc.log("Asset Helper init..."),(r={})[ddt.asset.horse_red]=null,r[ddt.asset.horse_yellow]=null,r[ddt.asset.horse_green]=null,r[ddt.asset.horse_blue]=null,(c={})[ddt.asset.horse_red]=null,c[ddt.asset.horse_yellow]=null,c[ddt.asset.horse_green]=null,c[ddt.asset.horse_blue]=null},isInGameAssetLoaded:function(){if(a!=ddt.userData.backgroundType)return!1;if(s!=ddt.userData.tableSkin)return!1;if(null!=ddt.userData.soundType)return!1;var e=[ddt.asset.horse_red,ddt.asset.horse_yellow,ddt.asset.horse_green,ddt.asset.horse_blue];for(var t in e){var n=e[t];if(c[n]!=ddt.userData.horseSkins[n])return!1}return!0},loadInGameAsset:function(e){var t=function(e,t,n){if(c[e]&&c[e]==ddt.userData.horseSkins[e])n(null);else{var i="in-game/horse/"+e+"-"+t;cc.loader.loadRes(i,cc.SpriteAtlas,function(i,o){i?n(i):(r[e]=o,c[e]=t,cc.log(e+"-"+t+" asset loaded"),n(null))})}},d=[function(e){n?e(null):cc.loader.loadRes("in-game/basic",cc.SpriteAtlas,function(t,i){t?e(t):(n=i,cc.log("basicAtlas asset loaded"),e(null))})},function(e){if(a&&a==ddt.userData.backgroundType)e(null);else{var t="in-game/table/"+ddt.userData.backgroundType;cc.loader.loadRes(t,cc.SpriteFrame,function(t,n){t?e(t):(i=n,a=ddt.userData.backgroundType,cc.log("background asset loaded"),e(null))})}},function(e){if(s&&s==ddt.userData.tableSkin)e(null);else{var t="in-game/table/"+ddt.userData.tableSkin;cc.loader.loadRes(t,cc.SpriteFrame,function(t,n){t?e(t):(o=n,s=ddt.userData.tableSkin,cc.log("table asset loaded"),e(null))})}},function(e){t(ddt.asset.horse_red,ddt.userData.horseSkins[ddt.asset.horse_red],e)},function(e){t(ddt.asset.horse_yellow,ddt.userData.horseSkins[ddt.asset.horse_yellow],e)},function(e){t(ddt.asset.horse_green,ddt.userData.horseSkins[ddt.asset.horse_green],e)},function(e){t(ddt.asset.horse_blue,ddt.userData.horseSkins[ddt.asset.horse_blue],e)}];l.waterfall(d,function(t){t?cc.log(t):e()})},getBasicSpriteFrame:function(e){return n.getSpriteFrame(e)},getBackgroundSpriteFrame:function(){return i},getTableSpriteFrame:function(){return o},getAvatarSpriteFrame:function(e){if(ddt.userData.tableSkin==ddt.asset.table_mars||ddt.userData.tableSkin==ddt.asset.table_beach){if(e==ddt.asset.icon_red_human||e==ddt.asset.icon_yellow_human)return this.getBasicSpriteFrame(ddt.asset.icon_white_human_left);if(e==ddt.asset.icon_blue_human||e==ddt.asset.icon_green_human)return this.getBasicSpriteFrame(ddt.asset.icon_white_human_right);if(e==ddt.asset.icon_red_bot||e==ddt.asset.icon_yellow_bot)return this.getBasicSpriteFrame(ddt.asset.icon_white_bot_left);if(e==ddt.asset.icon_blue_bot||e==ddt.asset.icon_green_bot)return this.getBasicSpriteFrame(ddt.asset.icon_white_bot_right)}return this.getBasicSpriteFrame(e)},getHorseSpriteFrame:function(e,t,n){var i=this.buildHorseFrameName(e,t,n);return r[e].getSpriteFrame(i)},buildHorseFrameName:function(e,t,n){return e+"-"+t+"_"+n},createHorseAnimClip:function(e,t,n,i){for(var o=[],a=0;a<n;a++){var s=this.buildHorseFrameName(e,t,a);o.push(s)}var c,l=[];for(c in o){var d=r[e].getSpriteFrame(o[c]);d&&l.push(d)}var u=cc.AnimationClip.createWithSpriteFrames(l,i);return u.wrapMode=cc.WrapMode.Loop,u},createBigGrinHorseClip:function(e){return this.createHorseAnimClip(e,ddt.asset.emotion_big_grin,8,8)},createAngryHorseClip:function(e){return this.createHorseAnimClip(e,ddt.asset.emotion_angry,5,8)},createHappyHorseClip:function(e){return this.createHorseAnimClip(e,ddt.asset.emotion_happy,7,10)},createSmileHorseClip:function(e){return this.createHorseAnimClip(e,ddt.asset.emotion_smile,8,8)}});t.exports=d,cc._RF.pop()},{async:2}],Asset:[function(e,t){"use strict";cc._RF.push(t,"17a10JEN25ENpMXi/fuDEjB","Asset");var n={icon_blue_bot:"icon-bluebot",icon_blue_human:"icon-bluehuman",icon_red_bot:"icon-redbot",icon_red_human:"icon-redhuman",icon_yellow_bot:"icon-yellowbot",icon_yellow_human:"icon-yellowhuman",icon_green_bot:"icon-greenbot",icon_green_human:"icon-greenhuman",icon_white_bot_left:"icon-whitebot-1",icon_white_bot_right:"icon-whitebot-2",icon_white_human_left:"icon-whitehuman-1",icon_white_human_right:"icon-whitehuman-2",horse_red:"red-h",horse_yellow:"yellow-h",horse_green:"green-h",horse_blue:"blue-h",emotion_smile:"smile",emotion_big_grin:"smile2",emotion_angry:"angry",emotion_happy:"happy",emotion_smile_frames:4,emotion_big_grin_frames:5,emotion_happy_frames:[0,6],emotion_angry_frames:[0,1,2,3,4],dice:"dice-",dice_1:"dice-1",dice_2:"dice-2",dice_3:"dice-3",dice_4:"dice-4",dice_5:"dice-5",dice_6:"dice-6",table_classic:"original-style",table_forest:"forest-style",table_beach:"beach-style",table_street:"street-style",table_mars:"mars-style",background_classic:"bg-original",background_forest:"bg-forest",background_beach:"bg-beach",background_street:"bg-street",background_mars:"bg-mars",skin_classic:"classic",skin_forest:"forest",skin_beach:"beach",skin_street:"street",skin_mars:"mars",sound_promotion:"promotion",sound_export:"export",sound_no_move:"no-move",sound_good_dice:"good-dice",sound_kick:"kick",sound_be_kicked:"be-kicked",sound_win:"win",horse_sample_number:8,getHorseAsset:function(e){switch(e){case ddt.PlayerID.Red:this.horse_red;break;case ddt.PlayerID.Yellow:this.horse_yellow;break;case ddt.PlayerID.Green:this.horse_green;break;default:return this.horse_blue}},getAudioFilePath:function(e){return"sound/"+ddt.userData.soundType+"/"+e}};t.exports=n,cc._RF.pop()},{}],AudioSource:[function(e,t){"use strict";cc._RF.push(t,"22d94jfzABPtKcE5PXgQVT9","AudioSource"),cc.Class({extends:cc.AudioSource,properties:{},onLoad:function(){},play:function(){ddt.userData.sound&&this._super()}}),cc._RF.pop()},{}],1:[function(e,t){var n,i,o=t.exports={};function r(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}function c(e){if(i===clearTimeout)return clearTimeout(e);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{return i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(function(){try{n="function"==typeof setTimeout?setTimeout:r}catch(e){n=r}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}})();var l,d=[],u=!1,h=-1;function p(){u&&l&&(u=!1,l.length?d=l.concat(d):h=-1,d.length&&f())}function f(){if(!u){var e=s(p);u=!0;for(var t=d.length;t;){for(l=d,d=[];++h<t;)l&&l[h].run();h=-1,t=d.length}l=null,u=!1,c(e)}}function y(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new y(e,t)),1!==d.length||u||s(f)},y.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(){return[]},o.binding=function(){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],Config:[function(e,t){"use strict";cc._RF.push(t,"0a6132Sfe9IN7PciGZF90Kg","Config");var n=cc.Class({name:"Config",properties:{autoMove:!0,autoDice:!0,sound:!0,numDices:1,playerTurn:-1,players:{default:[],type:Object}},ctor:function(){this.autoMove=!0,this.autoDice=!0,this.sound=!0,this.numDices=1,this.playerTurn=-1,this.players=[];for(var e=0;e<4;e++){for(var t=[],n=0;n<4;n++){var i={index:0,placeType:ddt.PlaceType.Stable};t.push(i)}var o={id:e,type:ddt.PlayerType.AI,active:!1,horses:t};this.players.push(o)}}});t.exports=n,cc._RF.pop()},{}],2:[function(e,t,n){(function(e){var i;i=function(t){"use strict";function n(e,...t){return(...n)=>e(...t,...n)}function i(e){return function(...t){var n=t.pop();return e.call(this,t,n)}}var o="function"==typeof queueMicrotask&&queueMicrotask,r="function"==typeof setImmediate&&setImmediate,a="object"==typeof e&&"function"==typeof e.nextTick;function s(e){setTimeout(e,0)}function c(e){return(t,...n)=>e(()=>t(...n))}var l=c(o?queueMicrotask:r?setImmediate:a?e.nextTick:s);function d(e){return p(e)?function(...t){const n=t.pop();return u(e.apply(this,t),n)}:i(function(t,n){var i;try{i=e.apply(this,t)}catch(o){return n(o)}if(i&&"function"==typeof i.then)return u(i,n);n(null,i)})}function u(e,t){return e.then(e=>{h(t,null,e)},e=>{h(t,e&&e.message?e:new Error(e))})}function h(e,t,n){try{e(t,n)}catch(i){l(e=>{throw e},i)}}function p(e){return"AsyncFunction"===e[Symbol.toStringTag]}function f(e){return"AsyncGenerator"===e[Symbol.toStringTag]}function y(e){return"function"==typeof e[Symbol.asyncIterator]}function m(e){if("function"!=typeof e)throw new Error("expected a function");return p(e)?d(e):e}function g(e,t=e.length){if(!t)throw new Error("arity is undefined");return function(...n){return"function"==typeof n[t-1]?e.apply(this,n):new Promise((i,o)=>{n[t-1]=(e,...t)=>{if(e)return o(e);i(t.length>1?t:t[0])},e.apply(this,n)})}}function v(e){return function(t,...n){return g(function(i){var o=this;return e(t,(e,t)=>{m(e).apply(o,n.concat(t))},i)})}}function _(e,t,n,i){t=t||[];var o=[],r=0,a=m(n);return e(t,(e,t,n)=>{var i=r++;a(e,(e,t)=>{o[i]=t,n(e)})},e=>{i(e,o)})}function S(e){return e&&"number"==typeof e.length&&e.length>=0&&e.length%1==0}const b={};function w(e){function t(...t){if(null!==e){var n=e;e=null,n.apply(this,t)}}return Object.assign(t,e),t}function T(e){return e[Symbol.iterator]&&e[Symbol.iterator]()}function k(e){var t=-1,n=e.length;return function(){return++t<n?{value:e[t],key:t}:null}}function C(e){var t=-1;return function(){var n=e.next();return n.done?null:(t++,{value:n.value,key:t})}}function P(e){if(S(e))return k(e);var t,n,i,o,r=T(e);return r?C(r):(n=(t=e)?Object.keys(t):[],i=-1,o=n.length,function e(){var r=n[++i];return"__proto__"===r?e():i<o?{value:t[r],key:r}:null})}function F(e){return function(...t){if(null===e)throw new Error("Callback was already called.");var n=e;e=null,n.apply(this,t)}}function x(e,t,n,i){let o=!1,r=!1,a=!1,s=0,c=0;function l(){s>=t||a||o||(a=!0,e.next().then(({value:e,done:t})=>{if(!r&&!o){if(a=!1,t)return o=!0,void(s<=0&&i(null));s++,n(e,c,d),c++,l()}}).catch(u))}function d(e,t){if(s-=1,!r)return e?u(e):!1===e?(o=!0,void(r=!0)):t===b||o&&s<=0?(o=!0,i(null)):void l()}function u(e){r||(a=!1,o=!0,i(e))}l()}var I=e=>(t,n,i)=>{if(i=w(i),e<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!t)return i(null);if(f(t))return x(t,e,n,i);if(y(t))return x(t[Symbol.asyncIterator](),e,n,i);var o=P(t),r=!1,a=!1,s=0,c=!1;function l(e,t){if(!a)if(s-=1,e)r=!0,i(e);else if(!1===e)r=!0,a=!0;else{if(t===b||r&&s<=0)return r=!0,i(null);c||d()}}function d(){for(c=!0;s<e&&!r;){var t=o();if(null===t)return r=!0,void(s<=0&&i(null));s+=1,n(t.value,t.key,F(l))}c=!1}d()},L=g(function(e,t,n,i){return I(t)(e,m(n),i)},4);function N(e,t,n){n=w(n);var i=0,o=0,{length:r}=e,a=!1;function s(e,t){!1===e&&(a=!0),!0!==a&&(e?n(e):++o!==r&&t!==b||n(null))}for(0===r&&n(null);i<r;i++)t(e[i],i,F(s))}function A(e,t,n){return L(e,1/0,t,n)}var D=g(function(e,t,n){return(S(e)?N:A)(e,m(t),n)},3),H=g(function(e,t,n){return _(D,e,t,n)},3),R=v(H),M=g(function(e,t,n){return L(e,1,t,n)},3),E=g(function(e,t,n){return _(M,e,t,n)},3),B=v(E);const O=Symbol("promiseCallback");function z(){let e,t;function n(n,...i){if(n)return t(n);e(i.length>1?i:i[0])}return n[O]=new Promise((n,i)=>{e=n,t=i}),n}function G(e,t,n){"number"!=typeof t&&(n=t,t=null),n=w(n||z());var i=Object.keys(e).length;if(!i)return n(null);t||(t=i);var o={},r=0,a=!1,s=!1,c=Object.create(null),l=[],d=[],u={};function h(e,t){l.push(()=>g(e,t))}function p(){if(!a){if(0===l.length&&0===r)return n(null,o);for(;l.length&&r<t;)l.shift()()}}function f(e,t){var n=c[e];n||(n=c[e]=[]),n.push(t)}function y(e){(c[e]||[]).forEach(e=>e()),p()}function g(e,t){if(!s){var i=F((t,...i)=>{if(r--,!1!==t)if(i.length<2&&([i]=i),t){var l={};if(Object.keys(o).forEach(e=>{l[e]=o[e]}),l[e]=i,s=!0,c=Object.create(null),a)return;n(t,l)}else o[e]=i,y(e);else a=!0});r++;var l=m(t[t.length-1]);t.length>1?l(o,i):l(i)}}function v(t){var n=[];return Object.keys(e).forEach(i=>{const o=e[i];Array.isArray(o)&&o.indexOf(t)>=0&&n.push(i)}),n}return Object.keys(e).forEach(t=>{var n=e[t];if(!Array.isArray(n))return h(t,[n]),void d.push(t);var i=n.slice(0,n.length-1),o=i.length;if(0===o)return h(t,n),void d.push(t);u[t]=o,i.forEach(r=>{if(!e[r])throw new Error("async.auto task `"+t+"` has a non-existent dependency `"+r+"` in "+i.join(", "));f(r,()=>{0==--o&&h(t,n)})})}),function(){for(var e=0;d.length;)e++,v(d.pop()).forEach(e=>{0==--u[e]&&d.push(e)});if(e!==i)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}(),p(),n[O]}var W=/^(?:async\s+)?(?:function)?\s*\w*\s*\(\s*([^)]+)\s*\)(?:\s*{)/,j=/^(?:async\s+)?\(?\s*([^)=]+)\s*\)?(?:\s*=>)/,U=/,/,J=/(=.+)?(\s*)$/,V=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;function Z(e){const t=e.toString().replace(V,"");let n=t.match(W);if(n||(n=t.match(j)),!n)throw new Error("could not parse args in autoInject\nSource:\n"+t);let[,i]=n;return i.replace(/\s/g,"").split(U).map(e=>e.replace(J,"").trim())}function q(e,t){var n={};return Object.keys(e).forEach(t=>{var i,o=e[t],r=p(o),a=!r&&1===o.length||r&&0===o.length;if(Array.isArray(o))i=[...o],o=i.pop(),n[t]=i.concat(i.length>0?s:o);else if(a)n[t]=o;else{if(i=Z(o),0===o.length&&!r&&0===i.length)throw new Error("autoInject task functions require explicit parameters.");r||i.pop(),n[t]=i.concat(s)}function s(e,t){var n=i.map(t=>e[t]);n.push(t),m(o)(...n)}}),G(n,t)}class K{constructor(){this.head=this.tail=null,this.length=0}removeLink(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,e.prev=e.next=null,this.length-=1,e}empty(){for(;this.head;)this.shift();return this}insertAfter(e,t){t.prev=e,t.next=e.next,e.next?e.next.prev=t:this.tail=t,e.next=t,this.length+=1}insertBefore(e,t){t.prev=e.prev,t.next=e,e.prev?e.prev.next=t:this.head=t,e.prev=t,this.length+=1}unshift(e){this.head?this.insertBefore(this.head,e):Y(this,e)}push(e){this.tail?this.insertAfter(this.tail,e):Y(this,e)}shift(){return this.head&&this.removeLink(this.head)}pop(){return this.tail&&this.removeLink(this.tail)}toArray(){return[...this]}*[Symbol.iterator](){for(var e=this.head;e;)yield e.data,e=e.next}remove(e){for(var t=this.head;t;){var{next:n}=t;e(t)&&this.removeLink(t),t=n}return this}}function Y(e,t){e.length=1,e.head=e.tail=t}function Q(e,t,n){if(null==t)t=1;else if(0===t)throw new RangeError("Concurrency must not be zero");var i=m(e),o=0,r=[];const a={error:[],drain:[],saturated:[],unsaturated:[],empty:[]};function s(e,t){a[e].push(t)}function c(e,t){const n=(...i)=>{d(e,n),t(...i)};a[e].push(n)}function d(e,t){return e?t?void(a[e]=a[e].filter(e=>e!==t)):a[e]=[]:Object.keys(a).forEach(e=>a[e]=[])}function u(e,...t){a[e].forEach(e=>e(...t))}var h=!1;function p(e,t,n,i){if(null!=i&&"function"!=typeof i)throw new Error("task callback must be a function");var o,r;function a(e,...t){return e?n?r(e):o():t.length<=1?o(t[0]):void o(t)}_.started=!0;var s={data:e,callback:n?a:i||a};if(t?_._tasks.unshift(s):_._tasks.push(s),h||(h=!0,l(()=>{h=!1,_.process()})),n||!i)return new Promise((e,t)=>{o=e,r=t})}function f(e){return function(t,...n){o-=1;for(var i=0,a=e.length;i<a;i++){var s=e[i],c=r.indexOf(s);0===c?r.shift():c>0&&r.splice(c,1),s.callback(t,...n),null!=t&&u("error",t,s.data)}o<=_.concurrency-_.buffer&&u("unsaturated"),_.idle()&&u("drain"),_.process()}}function y(e){return!(0!==e.length||!_.idle()||(l(()=>u("drain")),0))}const g=e=>t=>{if(!t)return new Promise((t,n)=>{c(e,(e,i)=>{if(e)return n(e);t(i)})});d(e),s(e,t)};var v=!1,_={_tasks:new K,*[Symbol.iterator](){yield*_._tasks[Symbol.iterator]()},concurrency:t,payload:n,buffer:t/4,started:!1,paused:!1,push(e,t){if(Array.isArray(e)){if(y(e))return;return e.map(e=>p(e,!1,!1,t))}return p(e,!1,!1,t)},pushAsync(e,t){if(Array.isArray(e)){if(y(e))return;return e.map(e=>p(e,!1,!0,t))}return p(e,!1,!0,t)},kill(){d(),_._tasks.empty()},unshift(e,t){if(Array.isArray(e)){if(y(e))return;return e.map(e=>p(e,!0,!1,t))}return p(e,!0,!1,t)},unshiftAsync(e,t){if(Array.isArray(e)){if(y(e))return;return e.map(e=>p(e,!0,!0,t))}return p(e,!0,!0,t)},remove(e){_._tasks.remove(e)},process(){if(!v){for(v=!0;!_.paused&&o<_.concurrency&&_._tasks.length;){var e=[],t=[],n=_._tasks.length;_.payload&&(n=Math.min(n,_.payload));for(var a=0;a<n;a++){var s=_._tasks.shift();e.push(s),r.push(s),t.push(s.data)}o+=1,0===_._tasks.length&&u("empty"),o===_.concurrency&&u("saturated");var c=F(f(e));i(t,c)}v=!1}},length:()=>_._tasks.length,running:()=>o,workersList:()=>r,idle:()=>_._tasks.length+o===0,pause(){_.paused=!0},resume(){!1!==_.paused&&(_.paused=!1,l(_.process))}};return Object.defineProperties(_,{saturated:{writable:!1,value:g("saturated")},unsaturated:{writable:!1,value:g("unsaturated")},empty:{writable:!1,value:g("empty")},drain:{writable:!1,value:g("drain")},error:{writable:!1,value:g("error")}}),_}function X(e,t){return Q(e,1,t)}function $(e,t,n){return Q(e,t,n)}var ee=g(function(e,t,n,i){i=w(i);var o=m(n);return M(e,(e,n,i)=>{o(t,e,(e,n)=>{t=n,i(e)})},e=>i(e,t))},4);function te(...e){var t=e.map(m);return function(...e){var n=this,i=e[e.length-1];return"function"==typeof i?e.pop():i=z(),ee(t,e,(e,t,i)=>{t.apply(n,e.concat((e,...t)=>{i(e,t)}))},(e,t)=>i(e,...t)),i[O]}}function ne(...e){return te(...e.reverse())}var ie=g(function(e,t,n,i){return _(I(t),e,n,i)},4),oe=g(function(e,t,n,i){var o=m(n);return ie(e,t,(e,t)=>{o(e,(e,...n)=>e?t(e):t(e,n))},(e,t)=>{for(var n=[],o=0;o<t.length;o++)t[o]&&(n=n.concat(...t[o]));return i(e,n)})},4),re=g(function(e,t,n){return oe(e,1/0,t,n)},3),ae=g(function(e,t,n){return oe(e,1,t,n)},3);function se(...e){return function(...t){return t.pop()(null,...e)}}function ce(e,t){return(n,i,o,r)=>{var a,s=!1;const c=m(o);n(i,(n,i,o)=>{c(n,(i,r)=>i||!1===i?o(i):e(r)&&!a?(s=!0,a=t(!0,n),o(null,b)):void o())},e=>{if(e)return r(e);r(null,s?a:t(!1))})}}var le=g(function(e,t,n){return ce(e=>e,(e,t)=>t)(D,e,t,n)},3),de=g(function(e,t,n,i){return ce(e=>e,(e,t)=>t)(I(t),e,n,i)},4),ue=g(function(e,t,n){return ce(e=>e,(e,t)=>t)(I(1),e,t,n)},3);function he(e){return(t,...n)=>m(t)(...n,(t,...n)=>{"object"==typeof console&&(t?console.error&&console.error(t):console[e]&&n.forEach(t=>console[e](t)))})}var pe=he("dir"),fe=g(function(e,t,n){n=F(n);var i,o=m(e),r=m(t);function a(e,...t){if(e)return n(e);!1!==e&&(i=t,r(...t,s))}function s(e,t){return e?n(e):!1!==e?t?void o(a):n(null,...i):void 0}return s(null,!0)},3);function ye(e,t,n){const i=m(t);return fe(e,(...e)=>{const t=e.pop();i(...e,(e,n)=>t(e,!n))},n)}function me(e){return(t,n,i)=>e(t,i)}var ge=g(function(e,t,n){return D(e,me(m(t)),n)},3),ve=g(function(e,t,n,i){return I(t)(e,me(m(n)),i)},4),_e=g(function(e,t,n){return ve(e,1,t,n)},3);function Se(e){return p(e)?e:function(...t){var n=t.pop(),i=!0;t.push((...e)=>{i?l(()=>n(...e)):n(...e)}),e.apply(this,t),i=!1}}var be=g(function(e,t,n){return ce(e=>!e,e=>!e)(D,e,t,n)},3),we=g(function(e,t,n,i){return ce(e=>!e,e=>!e)(I(t),e,n,i)},4),Te=g(function(e,t,n){return ce(e=>!e,e=>!e)(M,e,t,n)},3);function ke(e,t,n,i){var o=new Array(t.length);e(t,(e,t,i)=>{n(e,(e,n)=>{o[t]=!!n,i(e)})},e=>{if(e)return i(e);for(var n=[],r=0;r<t.length;r++)o[r]&&n.push(t[r]);i(null,n)})}function Ce(e,t,n,i){var o=[];e(t,(e,t,i)=>{n(e,(n,r)=>{if(n)return i(n);r&&o.push({index:t,value:e}),i(n)})},e=>{if(e)return i(e);i(null,o.sort((e,t)=>e.index-t.index).map(e=>e.value))})}function Pe(e,t,n,i){return(S(t)?ke:Ce)(e,t,m(n),i)}var Fe=g(function(e,t,n){return Pe(D,e,t,n)},3),xe=g(function(e,t,n,i){return Pe(I(t),e,n,i)},4),Ie=g(function(e,t,n){return Pe(M,e,t,n)},3),Le=g(function(e,t){var n=F(t),i=m(Se(e));return function e(t){if(t)return n(t);!1!==t&&i(e)}()},2),Ne=g(function(e,t,n,i){var o=m(n);return ie(e,t,(e,t)=>{o(e,(n,i)=>n?t(n):t(n,{key:i,val:e}))},(e,t)=>{for(var n={},{hasOwnProperty:o}=Object.prototype,r=0;r<t.length;r++)if(t[r]){var{key:a}=t[r],{val:s}=t[r];o.call(n,a)?n[a].push(s):n[a]=[s]}return i(e,n)})},4);function Ae(e,t,n){return Ne(e,1/0,t,n)}function De(e,t,n){return Ne(e,1,t,n)}var He=he("log"),Re=g(function(e,t,n,i){i=w(i);var o={},r=m(n);return I(t)(e,(e,t,n)=>{r(e,t,(e,i)=>{if(e)return n(e);o[t]=i,n(e)})},e=>i(e,o))},4);function Me(e,t,n){return Re(e,1/0,t,n)}function Ee(e,t,n){return Re(e,1,t,n)}function Be(e,t=(e=>e)){var n=Object.create(null),o=Object.create(null),r=m(e),a=i((e,i)=>{var a=t(...e);a in n?l(()=>i(null,...n[a])):a in o?o[a].push(i):(o[a]=[i],r(...e,(e,...t)=>{e||(n[a]=t);var i=o[a];delete o[a];for(var r=0,s=i.length;r<s;r++)i[r](e,...t)}))});return a.memo=n,a.unmemoized=e,a}var Oe=c(a?e.nextTick:r?setImmediate:s),ze=g((e,t,n)=>{var i=S(t)?[]:{};e(t,(e,t,n)=>{m(e)((e,...o)=>{o.length<2&&([o]=o),i[t]=o,n(e)})},e=>n(e,i))},3);function Ge(e,t){return ze(D,e,t)}function We(e,t,n){return ze(I(t),e,n)}function je(e,t){var n=m(e);return Q((e,t)=>{n(e[0],t)},t,1)}class Ue{constructor(){this.heap=[],this.pushCount=Number.MIN_SAFE_INTEGER}get length(){return this.heap.length}empty(){return this.heap=[],this}percUp(e){let t;for(;e>0&&Ve(this.heap[e],this.heap[t=Je(e)]);){let n=this.heap[e];this.heap[e]=this.heap[t],this.heap[t]=n,e=t}}percDown(e){let t;for(;(t=1+(e<<1))<this.heap.length&&(t+1<this.heap.length&&Ve(this.heap[t+1],this.heap[t])&&(t+=1),!Ve(this.heap[e],this.heap[t]));){let n=this.heap[e];this.heap[e]=this.heap[t],this.heap[t]=n,e=t}}push(e){e.pushCount=++this.pushCount,this.heap.push(e),this.percUp(this.heap.length-1)}unshift(e){return this.heap.push(e)}shift(){let[e]=this.heap;return this.heap[0]=this.heap[this.heap.length-1],this.heap.pop(),this.percDown(0),e}toArray(){return[...this]}*[Symbol.iterator](){for(let e=0;e<this.heap.length;e++)yield this.heap[e].data}remove(e){let t=0;for(let n=0;n<this.heap.length;n++)e(this.heap[n])||(this.heap[t]=this.heap[n],t++);this.heap.splice(t);for(let n=Je(this.heap.length-1);n>=0;n--)this.percDown(n);return this}}function Je(e){return(e+1>>1)-1}function Ve(e,t){return e.priority!==t.priority?e.priority<t.priority:e.pushCount<t.pushCount}function Ze(e,t){var n=je(e,t),i=!1;return n._tasks=new Ue,n.push=function(e,t=0,o=(()=>{})){if("function"!=typeof o)throw new Error("task callback must be a function");if(n.started=!0,Array.isArray(e)||(e=[e]),0===e.length&&n.idle())return l(()=>n.drain());for(var r=0,a=e.length;r<a;r++){var s={data:e[r],priority:t,callback:o};n._tasks.push(s)}i||(i=!0,l(()=>{i=!1,n.process()}))},delete n.unshift,n}var qe=g(function(e,t){if(t=w(t),!Array.isArray(e))return t(new TypeError("First argument to race must be an array of functions"));if(!e.length)return t();for(var n=0,i=e.length;n<i;n++)m(e[n])(t)},2);function Ke(e,t,n,i){var o=[...e].reverse();return ee(o,t,n,i)}function Ye(e){var t=m(e);return i(function(e,n){return e.push((e,...t)=>{let i={};if(e&&(i.error=e),t.length>0){var o=t;t.length<=1&&([o]=t),i.value=o}n(null,i)}),t.apply(this,e)})}function Qe(e){var t;return Array.isArray(e)?t=e.map(Ye):(t={},Object.keys(e).forEach(n=>{t[n]=Ye.call(this,e[n])})),t}function Xe(e,t,n,i){const o=m(n);return Pe(e,t,(e,t)=>{o(e,(e,n)=>{t(e,!n)})},i)}var $e=g(function(e,t,n){return Xe(D,e,t,n)},3),et=g(function(e,t,n,i){return Xe(I(t),e,n,i)},4),tt=g(function(e,t,n){return Xe(M,e,t,n)},3);function nt(e){return function(){return e}}const it=5,ot=0;function rt(e,t,n){var i={times:it,intervalFunc:nt(ot)};if(arguments.length<3&&"function"==typeof e?(n=t||z(),t=e):(at(i,e),n=n||z()),"function"!=typeof t)throw new Error("Invalid arguments for async.retry");var o=m(t),r=1;return function e(){o((t,...o)=>{!1!==t&&(t&&r++<i.times&&("function"!=typeof i.errorFilter||i.errorFilter(t))?setTimeout(e,i.intervalFunc(r-1)):n(t,...o))})}(),n[O]}function at(e,t){if("object"==typeof t)e.times=+t.times||it,e.intervalFunc="function"==typeof t.interval?t.interval:nt(+t.interval||ot),e.errorFilter=t.errorFilter;else{if("number"!=typeof t&&"string"!=typeof t)throw new Error("Invalid arguments for async.retry");e.times=+t||it}}function st(e,t){t||(t=e,e=null);let n=e&&e.arity||t.length;p(t)&&(n+=1);var o=m(t);return i((t,i)=>{function r(e){o(...t,e)}return(t.length<n-1||null==i)&&(t.push(i),i=z()),e?rt(e,r,i):rt(r,i),i[O]})}function ct(e,t){return ze(M,e,t)}var lt=g(function(e,t,n){return ce(Boolean,e=>e)(D,e,t,n)},3),dt=g(function(e,t,n,i){return ce(Boolean,e=>e)(I(t),e,n,i)},4),ut=g(function(e,t,n){return ce(Boolean,e=>e)(M,e,t,n)},3),ht=g(function(e,t,n){var i=m(t);return H(e,(e,t)=>{i(e,(n,i)=>{if(n)return t(n);t(n,{value:e,criteria:i})})},(e,t)=>{if(e)return n(e);n(null,t.sort(o).map(e=>e.value))});function o(e,t){var n=e.criteria,i=t.criteria;return n<i?-1:n>i?1:0}},3);function pt(e,t,n){var o=m(e);return i((i,r)=>{var a,s=!1;i.push((...e)=>{s||(r(...e),clearTimeout(a))}),a=setTimeout(function(){var t=e.name||"anonymous",i=new Error('Callback function "'+t+'" timed out.');i.code="ETIMEDOUT",n&&(i.info=n),s=!0,r(i)},t),o(...i)})}function ft(e){for(var t=Array(e);e--;)t[e]=e;return t}function yt(e,t,n,i){var o=m(n);return ie(ft(e),t,o,i)}function mt(e,t,n){return yt(e,1/0,t,n)}function gt(e,t,n){return yt(e,1,t,n)}function vt(e,t,n,i){arguments.length<=3&&"function"==typeof t&&(i=n,n=t,t=Array.isArray(e)?[]:{}),i=w(i||z());var o=m(n);return D(e,(e,n,i)=>{o(t,e,n,i)},e=>i(e,t)),i[O]}var _t=g(function(e,t){var n,i=null;return _e(e,(e,t)=>{m(e)((e,...o)=>{if(!1===e)return t(e);o.length<2?[n]=o:n=o,i=e,t(e?null:{})})},()=>t(i,n))});function St(e){return(...t)=>(e.unmemoized||e)(...t)}var bt=g(function(e,t,n){n=F(n);var i=m(t),o=m(e),r=[];function a(e,...t){if(e)return n(e);r=t,!1!==e&&o(s)}function s(e,t){return e?n(e):!1!==e?t?void i(a):n(null,...r):void 0}return o(s)},3);function wt(e,t,n){const i=m(e);return bt(e=>i((t,n)=>e(t,!n)),t,n)}var Tt=g(function(e,t){if(t=w(t),!Array.isArray(e))return t(new Error("First argument to waterfall must be an array of functions"));if(!e.length)return t();var n=0;function i(t){m(e[n++])(...t,F(o))}function o(o,...r){if(!1!==o)return o||n===e.length?t(o,...r):void i(r)}i([])}),kt={apply:n,applyEach:R,applyEachSeries:B,asyncify:d,auto:G,autoInject:q,cargo:X,cargoQueue:$,compose:ne,concat:re,concatLimit:oe,concatSeries:ae,constant:se,detect:le,detectLimit:de,detectSeries:ue,dir:pe,doUntil:ye,doWhilst:fe,each:ge,eachLimit:ve,eachOf:D,eachOfLimit:L,eachOfSeries:M,eachSeries:_e,ensureAsync:Se,every:be,everyLimit:we,everySeries:Te,filter:Fe,filterLimit:xe,filterSeries:Ie,forever:Le,groupBy:Ae,groupByLimit:Ne,groupBySeries:De,log:He,map:H,mapLimit:ie,mapSeries:E,mapValues:Me,mapValuesLimit:Re,mapValuesSeries:Ee,memoize:Be,nextTick:Oe,parallel:Ge,parallelLimit:We,priorityQueue:Ze,queue:je,race:qe,reduce:ee,reduceRight:Ke,reflect:Ye,reflectAll:Qe,reject:$e,rejectLimit:et,rejectSeries:tt,retry:rt,retryable:st,seq:te,series:ct,setImmediate:l,some:lt,someLimit:dt,someSeries:ut,sortBy:ht,timeout:pt,times:mt,timesLimit:yt,timesSeries:gt,transform:vt,tryEach:_t,unmemoize:St,until:wt,waterfall:Tt,whilst:bt,all:be,allLimit:we,allSeries:Te,any:lt,anyLimit:dt,anySeries:ut,find:le,findLimit:de,findSeries:ue,flatMap:re,flatMapLimit:oe,flatMapSeries:ae,forEach:ge,forEachSeries:_e,forEachLimit:ve,forEachOf:D,forEachOfSeries:M,forEachOfLimit:L,inject:ee,foldl:ee,foldr:Ke,select:Fe,selectLimit:xe,selectSeries:Ie,wrapSync:d,during:bt,doDuring:fe};t.default=kt,t.apply=n,t.applyEach=R,t.applyEachSeries=B,t.asyncify=d,t.auto=G,t.autoInject=q,t.cargo=X,t.cargoQueue=$,t.compose=ne,t.concat=re,t.concatLimit=oe,t.concatSeries=ae,t.constant=se,t.detect=le,t.detectLimit=de,t.detectSeries=ue,t.dir=pe,t.doUntil=ye,t.doWhilst=fe,t.each=ge,t.eachLimit=ve,t.eachOf=D,t.eachOfLimit=L,t.eachOfSeries=M,t.eachSeries=_e,t.ensureAsync=Se,t.every=be,t.everyLimit=we,t.everySeries=Te,t.filter=Fe,t.filterLimit=xe,t.filterSeries=Ie,t.forever=Le,t.groupBy=Ae,t.groupByLimit=Ne,t.groupBySeries=De,t.log=He,t.map=H,t.mapLimit=ie,t.mapSeries=E,t.mapValues=Me,t.mapValuesLimit=Re,t.mapValuesSeries=Ee,t.memoize=Be,t.nextTick=Oe,t.parallel=Ge,t.parallelLimit=We,t.priorityQueue=Ze,t.queue=je,t.race=qe,t.reduce=ee,t.reduceRight=Ke,t.reflect=Ye,t.reflectAll=Qe,t.reject=$e,t.rejectLimit=et,t.rejectSeries=tt,t.retry=rt,t.retryable=st,t.seq=te,t.series=ct,t.setImmediate=l,t.some=lt,t.someLimit=dt,t.someSeries=ut,t.sortBy=ht,t.timeout=pt,t.times=mt,t.timesLimit=yt,t.timesSeries=gt,t.transform=vt,t.tryEach=_t,t.unmemoize=St,t.until=wt,t.waterfall=Tt,t.whilst=bt,t.all=be,t.allLimit=we,t.allSeries=Te,t.any=lt,t.anyLimit=dt,t.anySeries=ut,t.find=le,t.findLimit=de,t.findSeries=ue,t.flatMap=re,t.flatMapLimit=oe,t.flatMapSeries=ae,t.forEach=ge,t.forEachSeries=_e,t.forEachLimit=ve,t.forEachOf=D,t.forEachOfSeries=M,t.forEachOfLimit=L,t.inject=ee,t.foldl=ee,t.foldr=Ke,t.select=Fe,t.selectLimit=xe,t.selectSeries=Ie,t.wrapSync=d,t.during=bt,t.doDuring=fe,Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==t?i(n):"function"==typeof define&&define.amd?define(["exports"],i):i(this.async={})}).call(this,e("_process"))},{_process:1}],Dice:[function(e,t){"use strict";cc._RF.push(t,"14ecefCJltOfpw6X+kSh8X5","Dice"),cc.Class({extends:cc.Component,properties:{_number:0,number:{get:function(){return this._number},set:function(e){this._number=e},_use:!0,use:{get:function(){return _use},set:function(e){this._use=e}}},restingLocation:cc.Vec2,rollingLocation:cc.Vec2,world:null,mapping:null},onLoad:function(){this.faces=[],this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.world=this.node.parent.getComponent("World"),this.mapping={"dice-red":cc.v2(115,879),"dice-blue":cc.v2(700,879),"dice-yellow":cc.v2(115,111),"dice-green":cc.v2(700,111)}},onTouchEnd:function(){var e=this.mapping[this.node.name];this.world.touchPoint=e},isActive:function(){return this.node.active},deactive:function(){this.node.active=!1},activate:function(){this.node.active=!0},changeFaceDice:function(){var e=this.faces.pop();this.setFaceDice(e)},showResult:function(){this.setFaceDice(this.number)},setFaceDice:function(e){this.node.getComponent(cc.Sprite).spriteFrame=ddt.assetHelper.getBasicSpriteFrame(ddt.asset.dice+e)},reset:function(){this.faces=[1,2,3,4,5,6],this.faces=this.shuffle(this.faces)},shuffle:function(e){var t,n,i;for(i=e.length-1;i>0;i--)t=Math.floor(Math.random()*(i+1)),n=e[i],e[i]=e[t],e[t]=n;return e},_moveToRollingLoc:function(e){if(0==e)return this.node.setPosition(this.rollingLocation),void this.node.setScale(1)},_moveToRestingLoc:function(e,t){0==e&&(this.node.setPosition(this.restingLocation),this.node.setScale(.5)),this.callback=t;var n=cc.moveTo(e,this.restingLocation),i=cc.scaleTo(e,.5),o=cc.sequence(cc.spawn(n,i),cc.callFunc(this.onMoveToRestingLocDone,this));this.node.stopAllActions(),this.node.runAction(o)},onMoveToRestingLocDone:function(){this.callback&&this.callback()},moveToRollingLocImmediate:function(){this._moveToRollingLoc(0)},moveToRestingLocImmediate:function(){this._moveToRestingLoc(0)},moveToRollingLoc:function(e,t){this._moveToRollingLoc(e,t)},moveToRestingLoc:function(e,t){this._moveToRestingLoc(e,t)}}),cc._RF.pop()},{}],EndLayer:[function(e,t){"use strict";cc._RF.push(t,"f375ai1motEHKUE/sPCKFip","EndLayer"),cc.Class({extends:cc.Component,properties:{horses:{default:[],type:e("Horse")},snows:{default:[],type:cc.Node},fireworks:{default:[],type:cc.Node},titleNode:cc.Node,replayBtnnode:cc.Node,exitBtnNode:cc.Node,replaySfList:{default:[],type:cc.SpriteFrame},exitSfList:{default:[],type:cc.SpriteFrame},world:e("World")},onLoad:function(){},show:function(){var e;switch(this.world.currentPlayer.id){case ddt.PlayerID.Red:e=ddt.lang.localize.team_red_name;break;case ddt.PlayerID.Yellow:e=ddt.lang.localize.team_yellow_name;break;case ddt.PlayerID.Green:e=ddt.lang.localize.team_green_name;break;default:e=ddt.lang.localize.team_blue_name}for(var t in this.titleNode.getComponent(cc.Label).string=ddt.lang.localize.congratulates_winner(e),this.replayBtnnode.getComponent(cc.Sprite).spriteFrame=this.replaySfList[ddt.lang.localizeId()],this.exitBtnNode.getComponent(cc.Sprite).spriteFrame=this.exitSfList[ddt.lang.localizeId()],this.horses){var n=this.horses[t],i=this.world.currentPlayer.horseAsset,o=n.animation;o.addClip(ddt.assetHelper.createHorseAnimClip(i,ddt.asset.emotion_happy,7,ddt.asset.horse_sample_number),ddt.asset.emotion_happy),o.play(ddt.asset.emotion_happy)}this.node.getComponent(cc.Widget).enable=!0,this.node.active=!0,this.node.setPosition(0,0),this.node.getComponent(cc.Animation).play("end-layer-in");var r=this;this.scheduleOnce(function(){for(var e in r.getComponent("AudioSource").play(),r.snows){var t=r.snows[e];t.active=!0,t.getComponent(cc.ParticleSystem).resetSystem()}this.startFireWork(),this.schedule(function(){r.startFireWork()},2)},.3)},startFireWork:function(){var e=this,t=function(t,n){e.scheduleOnce(function(){var e=701*Math.random()-350,n=701*Math.random()-200;t.setPosition(e,n),t.getComponent(cc.ParticleSystem).resetSystem(),t.getComponent("AudioSource").play()},n)};for(var n in e.fireworks){var i=e.fireworks[n];i.active=!0,t(i,.008*Math.floor(100*Math.random()))}}}),cc._RF.pop()},{Horse:"Horse",World:"World"}],Event:[function(e,t){"use strict";cc._RF.push(t,"f9b6brvnslOtqSOvMFWOfe6","Event"),t.exports={local_world_reoder:"world-reorder",local_world_kick:"world-kick",local_world_promotion:"world-promotion",local_world_export_horse:"world-export-horse",local_world_horse_move:"world-horse-move",local_world_good_rolling:"world-good-rolling",local_world_no_move:"world-no-move",local_world_win:"world-win",local_world_horse_step:"world-horse-step",local_world_dicing:"world-dicing",local_horse_state_changed:"horse_state_changed"},cc._RF.pop()},{}],FSM:[function(e,t){"use strict";cc._RF.push(t,"79b02N3MdNA7YcPFlE1PKuH","FSM");var n=cc.Class({name:"FSM",properties:{currentState:{get:function(){return null==this.states||0==this.states.length?null:this.states.slice(-1)[0]},visible:!1}},ctor:function(){},init:function(e){this.world=e,this.running=!1,this.states=[],this.scheduleDuration=0,this.scheduleTime=0,this.isSchedule=!1,this.scheduleCallback=null,this.end=!1},start:function(){this.running=!0,this.end=!1},changeState:function(e){if(0!=this.states.length){var t=this.states.pop();t.onExit(this.world),t.cleanup()}this.states.push(e),e.init(),e.onEnter(this.world)},pushState:function(e){0!=this.states.length&&this.states[this.states.length-1].pause(),this.states.push(e),e.init()},popState:function(){var e;0!=this.states.length&&((e=this.states.pop()).onExit(this.world),e.cleanup()),0!=this.states.length&&(e=this.states[this.states.length-1]).resume()},loop:function(e){if(this.isSchedule){if(this.scheduleTime>this.scheduleDuration)return this.isSchedule=!1,this.scheduleDuration=0,void this.scheduleCallback();this.scheduleTime+=e}else this.handleInputs(e),this.update(e),this.lateUpdate(e)},handleInputs:function(e){var t=this.states[this.states.length-1];t&&t.isRunning()&&t.handleInputs(this.world,e)},update:function(e){var t=this.states[this.states.length-1];t&&t.isRunning()&&t.update(this.world,e)},lateUpdate:function(e){var t=this.states[this.states.length-1];t&&t.isRunning()&&t.lateUpdate(this.world,e)},cleanup:function(){for(;0!=this.states.length;)this.states.pop().cleanup()},isRunning:function(){return this.running},pause:function(){this.running=!1},resume:function(){this.running=!0},schedule:function(e,t){this.isSchedule=!0,this.scheduleTime=0,this.scheduleDuration=t,this.scheduleCallback=e},quit:function(){this.running=!1,this.cleanup(),this.end=!0}});t.exports=n,cc._RF.pop()},{}],FadeTransition:[function(e,t){"use strict";cc._RF.push(t,"feb5eLNB5ROwpdEsctMDuBV","FadeTransition"),cc.Class({extends:cc.Component,properties:{duration:0},onLoad:function(){this.outOfWorld=cc.v2(3e3,0),this.node.position=this.outOfWorld;var e=cc.callFunc(this.onFadeOutFinish,this),t=cc.callFunc(this.onFadeInFinish,this);this.actionFadeIn=cc.sequence(cc.fadeTo(this.duration,255),t),this.actionFadeOut=cc.sequence(cc.fadeTo(this.duration,0),e),this.node.on("fade-in",this.startFadeIn,this),this.node.on("fade-out",this.startFadeOut,this)},startFadeIn:function(){cc.eventManager.pauseTarget(this.node,!0),this.node.position=cc.v2(0,0),this.node.setScale(2),this.node.opacity=0,this.node.runAction(this.actionFadeIn)},startFadeOut:function(){cc.eventManager.pauseTarget(this.node,!0),this.node.runAction(this.actionFadeOut)},onFadeInFinish:function(){cc.eventManager.resumeTarget(this.node,!0)},onFadeOutFinish:function(){this.node.position=this.outOfWorld,this.node.active=!1}}),cc._RF.pop()},{}],FileHelper:[function(e,t){"use strict";cc._RF.push(t,"ff340/DCPRInZcIDC2awe2g","FileHelper");var n={getData:function(e){if(!cc.sys.isNative)return cc.sys.localStorage.getItem(e);var t=jsb.fileUtils.getWritablePath()+e;return jsb.fileUtils.isFileExist(t)?jsb.fileUtils.getValueMapFromFile(t).data:null},isFileExist:function(e){if(cc.sys.isNative){var t=jsb.fileUtils.getWritablePath()+e;return jsb.fileUtils.isFileExist(t)}return cc.sys.localStorage.getItem(e)},removeData:function(e){return cc.sys.isNative?jsb.fileUtils.removeFile(e):cc.sys.localStorage.removeItem(e)},saveGameData:function(e,t){if(cc.sys.isNative){var n=jsb.fileUtils.getWritablePath()+t;cc.log("Saving to path:  "+n),jsb.fileUtils.writeToFile({data:JSON.stringify(e)},n)?cc.log("Save successfully!"):cc.log("Save FAILED!")}else cc.sys.localStorage.setItem(t,JSON.stringify(e))},loadGameData:function(){if(cc.sys.isNative){cc.log("loading game data");var e=jsb.fileUtils.getWritablePath();if(jsb.fileUtils.isFileExist(e)){var t=jsb.fileUtils.getValueMapFromFile(e);JSON.parse(t.data)}else cc.log("no saved game data found")}else{var n=cc.sys.localStorage.getItem("");null!=n&&JSON.parse(n)}}};t.exports=n,cc._RF.pop()},{}],GamePlay:[function(e,t){"use strict";cc._RF.push(t,"114d0wFR9FKoo4b0oYzrdwe","GamePlay"),e("Types").AssetStyle;var n=e("TestPlay"),i=e("Config");cc.Class({extends:cc.Component,properties:{world:e("World"),tableNode:cc.Node,config:e("Config"),testPlay:{default:null,type:n,visible:!1},pauseLayer:cc.Node,playLayer:cc.Node,endLayer:cc.Node,speedLb:cc.Label,topbarNode:cc.Node,utilityNode:cc.Node},onLoad:function(){var e=cc.winSize;e.height/e.width<1.4&&(this.tableNode.scale=.85),console.log("World init..."),this.world.init(),this.speedLb.string="x"+this.world.speed,this.testPlay=new n,this.testPlay.init(this.world),this.shouldShowIntertitialAd=!1,this.testPlay.isTestLogic()&&(this.config=this.testPlay.testWinCondition())},startAfter:function(e){null==this.config&&(this.config=this.testPlay.test2HummanPlayers(),this.config=this.testPlay.testWinCondition());var t=this,n=function(){t.world.prepare(t.config),t.playLayer.active=!0,setTimeout(function(){t.world.play()},e)};ddt.assetHelper.isInGameAssetLoaded()?n():ddt.assetHelper.loadInGameAsset(function(){n()})},start:function(){this.startAfter(500)},replay:function(){this.endLayer.active=!1,this.endLayer.setPosition(3e3,0),this.topbarNode.getComponent(cc.Animation).play("topbar-in"),this.utilityNode.getComponent(cc.Animation).play("utility-bar-in");var e=new i;for(var t in this.config.players){var n=this.config.players[t],o=e.players[t];o.type=n.type,o.active=n.active}this.config=e,this.startAfter(1e3)},showGameEnd:function(){this.topbarNode.getComponent(cc.Animation).play("topbar-out"),this.utilityNode.getComponent(cc.Animation).play("utility-bar-out"),this.endLayer.active=!0},backBtnPressed:function(){this.world.isRunning()&&(this.world.fsm.pause(),this.pauseLayer.active=!0,this.scheduleOnce(function(){},.3))},shopBtnPressed:function(){this.world.isRunning()&&(this.world.fsm.pause(),this.shopLayer.getComponent("ShopLayer").show())},showStartLayer:function(){this.world.fsm.pause(),this.startLayer.getComponent(cc.Animation).play("start-in")},hideStartLayer:function(){this.startLayer.getComponent(cc.Animation).play("start-out"),this.world.fsm.resume()},continues:function(){this.pauseLayer.emit("fade-out"),this.world.fsm.resume()},replayBtnPressed:function(){cc.sys.platform!=cc.sys.WIN32&&cc.sys.platform!=cc.sys.MACOS||this.replay()},exitGame:function(e,t){"no-save"!=t&&ddt.userData.saveGame(this.world),cc.director.loadScene("menu")},statisticBtnPressed:function(){this.world.isRunning()&&(this.world.fsm.pause(),this.statisLayer.active=!0,this.statisLayer.emit("fade-in"))},closeStatisDialogBtnPressed:function(){this.statisLayer.emit("fade-out");var e=this;this.scheduleOnce(function(){e.world.fsm.resume()},.3)},closeShopDialogBtnPressed:function(){var e=this,t=function(){e.shopLayer.getComponent(cc.Animation).play("shop-slide-out"),ddt.userData.saveSkin(),e.scheduleOnce(function(){e.world.fsm.resume()},.3)};ddt.assetHelper.isInGameAssetLoaded()?t():ddt.assetHelper.loadInGameAsset(function(){e.world.reskin(),t()})},speedBtnPressed:function(){this.world.speed++,this.world.speed>3&&(this.world.speed=1),this.speedLb.string="x"+this.world.speed}}),cc._RF.pop()},{Config:"Config",TestPlay:"TestPlay",Types:"Types",World:"World"}],GameRule:[function(e,t){"use strict";cc._RF.push(t,"28a5bFk1RdOOZjTc/n3Mud6","GameRule");var n=e("Types").PlaceType,i=(e("Types").PlayerID,cc.Class({name:"GameRule",checkWin:function(e){for(var t=!0,n=e.tower.length-1;n>1;n--)if(null==e.tower[n].horse){t=!1;break}return t},canExportHorse:function(e,t){var n=e.in.horse;if(n&&n.owner==e)return!1;var i=e.horses,o=!1;for(var r in i){var a=i[r];if(a.currentPlace==a.stablePlace){o=!0;break}}if(o)if(1==t.length)o=6==t[0];else if(2==t.length){var s=t[0],c=t[1];o=6==s||6==c||1==s&&1==c}return o},isMoreTurn:function(e){return this.isSuperDice(e)},isSuperDice:function(e){if(1==e.length)return 6==e[0];if(2==e.length){var t=e[0],n=e[1];return 6==t||6==n||1==t&&1==n}},computeStep:function(e){var t=0;return 1==e.length?t=e[0]:e.length,t},findPath:function(e,t){var i=t.currentPlace,o=e.getDiceFaceNumber();return i==t.stablePlace?this._findWhenAtStable(e,t,o):i.placeType==n.Fame?this._findWhenAtFame(e,t,o):i&&i.areaType==e.id&&i.placeType==n.Out?this._findWhenAtOut(e,t,o):this._findWhenOnJourney(e,t,o)},canKick:function(e,t,n){var i=t.currentPlace;if(i.placeType==ddt.PlaceType.Fame||i.placeType==ddt.PlaceType.Stable)return!1;if(n){var o=n.slice(-1)[0];return o.horse&&o.horse.owner!=e}return!1},canFight:function(e,t){var n=t.currentPlace;if(n.placeType==ddt.PlaceType.Fame||n.placeType==ddt.PlaceType.Stable||n.placeType==ddt.PlaceType.Out)return!1;for(var i=0,o=null,r=n;null==(o=(r=r.nextPlaceHoder).horse);)i++;return(!o||o.owner!=t.owner)&&i<7},canDanger:function(e,t){var n=t.currentPlace;if(n.placeType==ddt.PlaceType.Fame||n.placeType==ddt.PlaceType.Stable)return!1;for(var i=0,o=null,r=n;null==(o=(r=r.prevPlace).horse);)i++;return!(o&&o.owner==t.owner||o.currentPlace.placeType==ddt.PlaceType.Out)&&i<7},_findWhenAtStable:function(e,t,n){var i=[];return!this.isSuperDice(n)||null!=e.in.horse&&e.in.horse.owner==t.owner?null:(i.push(e.in),i)},_findWhenAtFame:function(e,t,n){var i=t.currentPlace,o=e.tower,r=o.indexOf(i),a=this.computeStep(n);if(r==o.length-1)return null;if(a>o.length||a-1<=r)return null;for(var s=[],c=r+1;c<a;c++){var l=o[c];if(l.horse)return null;s.push(l)}return s},_findWhenAtOut:function(e,t,n){for(var i=e.tower[0],o=[i],r=this.computeStep(n),a=0;a<r;a++){if(i.horse){o=null;break}if(a==r-1)break;if(null==(i=i.nextPlaceHoder)){o=null;break}o.push(i)}return o},_findWhenOnJourney:function(e,t,i){for(var o=this.computeStep(i),r=t.currentPlace,a=[],s=0;s<o;s++){if(r=r.nextPlaceHoder,a.push(r),r.placeType==n.Out&&r.areaType==t.owner.id){if(r.horse&&r.horse.owner==t.owner){a=null;break}s!=o-1&&(a=null);break}if(r.horse){if(s==o-1&&r.horse.owner!=t.owner)break;a=null;break}}return a}}));t.exports=i,cc._RF.pop()},{Types:"Types"}],Global:[function(e,t){"use strict";cc._RF.push(t,"553b3G2V05MsLaRIOApHpZS","Global");var n=e("UserData"),i=e("FileHelper"),o=e("AssetHelper"),r=e("Asset"),a=e("Types"),s=e("Event"),c=e("Lang");window.ddt={lang:null,userData:null,fileHelper:null,assetHelper:null,asset:null,event:null,world:null,LuckyLevel:null,PlayerID:null,PlaceType:null,AssetType:null,PlayerType:null,HorseState:null,playerTotal:0,director:1,sound:!0,music:!0,isComputer:!1,humanId:0,stepsTotal:[0,0,0,0],horseNodes:[],alert:function(e,t){cc.sys.platform==cc.sys.ANDROID?jsb.reflection.callStaticMethod("com.adsoft.ludohorseracing/AppActivity","alert","(Ljava/lang/String;Ljava/lang/String;)V",e,t):cc.sys.platform==cc.sys.IPHONE||(cc.sys.platform,cc.sys.IPAD)}},cc.game.on(cc.game.EVENT_GAME_INITED,function(){cc.log("Game inited. We will load user data"),ddt.lang=new c,ddt.lang.init(),ddt.lang.localize.game,ddt.lang.localize.admob_banner_id_ios,ddt.lang.localize.admob_interstitial_id_ios,ddt.userData=n,ddt.fileHelper=i,ddt.assetHelper=o,ddt.asset=r,ddt.event=s,ddt.PlayerID=a.PlayerID,ddt.PlaceType=a.PlaceType,ddt.AssetType=a.AssetType,ddt.PlayerType=a.PlayerType,ddt.LuckyLevel=a.LuckyLevel,ddt.HorseState=a.HorseState,o.init(),n.load()}),cc._RF.pop()},{Asset:"Asset",AssetHelper:"AssetHelper",Event:"Event",FileHelper:"FileHelper",Lang:"Lang",Types:"Types",UserData:"UserData"}],HorseSelection:[function(e,t){"use strict";cc._RF.push(t,"d61ebvxIXlLN4Gv5LmwysMp","HorseSelection");var n=e("Types").PlayerID;cc.Class({extends:cc.Component,properties:{horseList:{default:[],type:[cc.SpriteFrame]},horseSp:cc.Sprite,selectionNode:cc.Node,oppositeSelection:{default:null,type:cc.Node},isHuman:!1,id:{default:n.Red,type:n},clickEffect:cc.AudioSource},onLoad:function(){this.selected=!1,this.selectionNode.active=!1,this.id>-1&&this.id<4&&(this.horseSp.spriteFrame=this.horseList[this.id]),this.id;var e=this;this.node.on(cc.Node.EventType.TOUCH_START,function(){ddt.userData.sound&&e.clickEffect.play()})},changeSelection:function(e){this.selected=e,this.selectionNode.active=this.selected},isSelected:function(){return this.selected},click:function(){this.changeSelection(!this.selected),this.selected&&this.oppositeSelection.getComponent("HorseSelection").changeSelection(!1)}}),cc._RF.pop()},{Types:"Types"}],HorseSkinSelection:[function(e,t){"use strict";cc._RF.push(t,"11fc3r+tSNJ67UdlFa/6gjl","HorseSkinSelection");var n=e("HorseSkin");cc.Class({extends:cc.Component,properties:{horseSkins:{default:[],type:n},playerId:{default:e("Types").PlayerID.Red,type:e("Types").PlayerID}},onLoad:function(){for(var e in this.horseSkins)this.horseSkins[e].playerId=this.playerId},reset:function(){for(var e in this.horseSkins)this.horseSkins[e].setSelection(!1)}}),cc._RF.pop()},{HorseSkin:"HorseSkin",Types:"Types"}],HorseSkin:[function(e,t){"use strict";cc._RF.push(t,"a2837cn3shC5pcj7Lz1/rkp","HorseSkin"),cc.Class({extends:cc.Component,properties:{selection:cc.Node,horseSprite:cc.Node,parentNode:cc.Node,playerId:{default:e("Types").PlayerID.Red,type:e("Types").PlayerID},skin:""},onLoad:function(){var e;switch(this.playerId){case ddt.PlayerID.Blue:e=ddt.asset.horse_blue;break;case ddt.PlayerID.Green:e=ddt.asset.horse_green;break;case ddt.PlayerID.Yellow:e=ddt.asset.horse_yellow;break;default:e=ddt.asset.horse_red}this.horseName=e,this.setSelection(ddt.userData.horseSkins[this.horseName]==this.skin)},click:function(){this.selection.active||(this.parentNode.getComponent("HorseSkinSelection").reset(),this.selection.active=!0,ddt.userData.horseSkins[this.horseName]=this.skin)},setSelection:function(e){this.selection.active=e}}),cc._RF.pop()},{Types:"Types"}],HorseSound:[function(e,t){"use strict";cc._RF.push(t,"da7cc7BQsJK2LAna7C/WaIx","HorseSound"),cc.Class({extends:cc.Component,properties:{fightingEffect:{default:null,type:cc.AudioClip},hiEffect:{default:null,type:cc.AudioClip},imHomeEffect:{default:null,type:cc.AudioClip},ohohEffect:{default:null,type:cc.AudioClip},sorryEffect:{default:null,type:cc.AudioClip},tadaEffect:{default:null,type:cc.AudioClip},yeahEffect:{default:null,type:cc.AudioClip}},onLoad:function(){this.node.on("fighting",this.fighting,this),this.node.on("hi",this.hi,this),this.node.on("imHome",this.imHome,this),this.node.on("ohoh",this.ohoh,this),this.node.on("sorry",this.sorry,this),this.node.on("tada",this.tada,this),this.node.on("yeah",this.yeah,this)},fighting:function(){cc.audioEngine.playEffect(this.fightingEffect)},hi:function(){cc.audioEngine.play(ddt.asset.getAudioFilePath(ddt.asset.sound_export))},imHome:function(){cc.audioEngine.playEffect(this.imHomeEffect)},ohoh:function(){cc.audioEngine.playEffect(this.ohohEffect)},sorry:function(){cc.audioEngine.playEffect(this.sorryEffect)},tada:function(){cc.audioEngine.playEffect(this.tadaEffect)},yeah:function(){cc.audioEngine.playEffect(this.yeahEffect)}}),cc._RF.pop()},{}],HorseState:[function(e,t){"use strict";cc._RF.push(t,"dd8b3Bd1U9JG4+oiq/A4oMR","HorseState");var n=e("Horse");cc.Class({extends:cc.Component,properties:{horse:n,animation:cc.Animation},onLoad:function(){this.activate=!1,this.node.on(ddt.event.local_horse_state_changed,this.onStateChange,this),this.delay=0,this.time=0},onEnable:function(){this.activate=!0,this.name=this.horse.owner?this.horse.owner.horseAsset:""},onStateChange:function(){if(this.activate){this.animation.stop();var e=this.horse.renderNode.getComponent(cc.Sprite);switch(this.horse.state){case ddt.HorseState.TopFame:0==this.delay&&((t=ddt.assetHelper.createHappyHorseClip(this.name)).wrapMode=cc.WrapMode.Normal,this.animation.addClip(t,ddt.asset.emotion_happy),this.animation.play(ddt.asset.emotion_happy),this.delay=7*Math.random()+3,this.time=0);break;case ddt.HorseState.OnFame:this.delay=0,e.spriteFrame=ddt.assetHelper.getHorseSpriteFrame(this.name,ddt.asset.emotion_happy,0);break;case ddt.HorseState.Dispointed:this.delay=0,e.spriteFrame=ddt.assetHelper.getHorseSpriteFrame(this.name,ddt.asset.emotion_angry,0);break;case ddt.HorseState.Stable:case ddt.HorseState.OnJourney:this.delay=0,e.spriteFrame=ddt.assetHelper.getHorseSpriteFrame(this.name,ddt.asset.emotion_smile,0);break;case ddt.HorseState.Fighter:this.delay=0,e.spriteFrame=ddt.assetHelper.getHorseSpriteFrame(this.name,ddt.asset.emotion_big_grin,0);break;case ddt.HorseState.Danger:this.delay=0,e.spriteFrame=ddt.assetHelper.getHorseSpriteFrame(this.name,ddt.asset.emotion_angry,0);break;case ddt.HorseState.StartJourney:this.delay=3,this.time=0;var t=ddt.assetHelper.createAngryHorseClip(this.name);this.animation.addClip(t,ddt.asset.emotion_smile),this.animation.play(ddt.asset.emotion_smile);break;case ddt.HorseState.BeKick:this.time=0,this.delay=3,t=ddt.assetHelper.createAngryHorseClip(this.name),this.animation.addClip(t,ddt.asset.emotion_angry),this.animation.play(ddt.asset.emotion_angry);break;case ddt.HorseState.Kick:t=ddt.assetHelper.createBigGrinHorseClip(this.name),this.animation.addClip(t,ddt.asset.emotion_big_grin),this.animation.play(ddt.asset.emotion_big_grin);break;default:this.time=0,this.delay=0}}},update:function(e){this.delay>0&&(this.time>this.delay&&(this.horse.state==ddt.HorseState.BeKick?(this.delay=0,this.horse.state=ddt.HorseState.Stable,this.node.emit(ddt.event.local_horse_state_changed)):this.horse.state==ddt.HorseState.TopFame&&(this.animation.play(ddt.asset.emotion_happy,0),this.delay=7*Math.random()+3,this.time=0)),this.time+=e)}}),cc._RF.pop()},{Horse:"Horse"}],Horse:[function(e,t){"use strict";cc._RF.push(t,"c573c5OZPlFaZkt/qNQ/dyK","Horse"),cc.Class({extends:cc.Component,properties:{renderNode:cc.Node,animation:cc.Animation,id:0,state:{default:e("Types").HorseState.Stable,type:e("Types").HorseState},world:null},init:function(e,t,n){this.targetPlace=null,this.owner=e,this.stablePlace=t,this.currentPlace=t,this.node.getComponentInChildren(cc.Sprite).getComponentInChildren(cc.Sprite).spriteFrame=n},onLoad:function(){this.renderPosition=this.renderNode.getPosition(),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.world=this.node.parent.getComponent("World")},onTouchEnd:function(){this.world.touchPoint=this.node.position.clone().add(cc.v2(1,1))},getRect:function(){var e=this.node.getPosition(),t=this.renderNode.getPosition(),n=this.renderNode.getContentSize();return e.add(t),cc.rect(e.x,e.y,n.width,n.height)},setCurrentPlace:function(e,t){void 0===t&&(t=!1),this.currentPlace=e,this.node.setPosition(e.location),t&&(this.currentPlace.horse=this)},returnStable:function(){this.targetPlace=null,this.renderNode.setPosition(0,0),this.renderNode.setRotation(0),this.renderNode.anchorY=0,this.setCurrentPlace(this.stablePlace,!0)},showMovable:function(e){if(void 0===e&&(e=!0),this.renderNode.stopAllActions(),e){var t=cc.jumpTo(.3,this.renderPosition,20,1),n=cc.repeatForever(t);this.renderNode.runAction(n)}else this.renderNode.setPosition(this.renderPosition)},updateState:function(e){var t=e.fsm.currentState;if(null!=t){if(this.currentPlace.placeType==ddt.PlaceType.Fame)this.currentPlace==this.owner.tower.slice(-1)[0]?this.state=ddt.HorseState.TopFame:this.state=ddt.HorseState.OnFame;else if(this.currentPlace.placeType==ddt.PlaceType.Stable)if(e.currentPlayer==this.owner){var n=ddt.HorseState.Stable;"DiceState"==t.description&&this.owner.suggestMoves&&0==this.owner.suggestMoves.length&&(n=ddt.HorseState.Dispointed),this.state=n}else this.state!=ddt.HorseState.TopFame&&this.state!=ddt.HorseState.OnFame&&(this.state,ddt.HorseState.Stable),this.state=ddt.HorseState.Stable;else if("DiceState"==t.description){if(e.currentPlayer==this.owner){this.owner.getDiceFaceNumber();var i=e.gameRule.findPath(this.owner,this);if(null==i)return;e.gameRule.canKick(this.owner,this,i)&&(this.state=ddt.HorseState.Kick)}}else if("MoveState"==t.description){var o=e.gameRule.canDanger(this.owner,this),r=e.gameRule.canFight(this.owner,this);r&&(this.state=ddt.HorseState.Fighter),o&&(this.state=ddt.HorseState.Danger),(r&&o||!r&&!o)&&(this.currentPlace.placeType==ddt.PlaceType.In&&this.currentPlace.areaType==this.owner.id?this.state=ddt.HorseState.StartJourney:this.state=ddt.HorseState.OnJourney)}this.node.emit(ddt.event.local_horse_state_changed)}}}),cc._RF.pop()},{Types:"Types"}],Init:[function(e,t){"use strict";cc._RF.push(t,"51b63ONMbhOh4LeOFkVhXfz","Init"),cc.Class({extends:cc.Component,properties:{},start:function(){}}),cc._RF.pop()},{}],ItemShop:[function(e,t){"use strict";cc._RF.push(t,"67ca8klFENHTLJPnpCWriVn","ItemShop"),cc.Class({extends:cc.Component,properties:{label_price:cc.Label,label_value:cc.Label},setInfo:function(e,t){this.label_price.string=e,this.label_value.string=t}}),cc._RF.pop()},{}],Lang:[function(e,t){"use strict";cc._RF.push(t,"f982c8YLptPGYHnBJhzDYY6","Lang"),cc.Class({properties:{_currentLangCode:"en",currentLangCode:{get:function(){return this._currentLangCode},set:function(e){this._currentLangCode=e}},localize:null},init:function(){this.load()},load:function(){this.localize=e("vn"==this.currentLangCode.toLowerCase()?"vi":"en")},switch:function(){"vn"==this._currentLangCode.toLowerCase()?this.currentLangCode="en":this.currentLangCode="vn",this.load()},isVi:function(){return"vn"==this._currentLangCode.toLowerCase()},localizeId:function(){return this.isVi()?1:0}}),cc._RF.pop()},{}],LoadingScreen:[function(e,t){"use strict";cc._RF.push(t,"c9eb5+J1KRKyYtYh+0FxC1l","LoadingScreen"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.node.active=!1}}),cc._RF.pop()},{}],MenuSidebar:[function(e,t){"use strict";cc._RF.push(t,"9b817fxeypCg45bPNzKwsK3","MenuSidebar"),cc.Class({extends:cc.Component,properties:{tabIcons:{default:[],type:cc.SpriteFrame},tabPrefab:cc.v2refab,container:cc.Node,highlight:cc.Node,tabWidth:0},init:function(e){this.mainMenu=e,this.tabSwitchDuration=.3,this.curTabIdx=0,this.tabs=[];for(var t=0;t<this.tabIcons.length;++t){var n=this.tabIcons[t],i=cc.instantiate(this.tabPrefab).getComponent("TabCtrl");this.container.addChild(i.node),i.init({sidebar:this,idx:t,iconSF:n}),this.tabs[t]=i,t==this.tabIcons.length-1&&(i.dividerNode.active=!1)}this.tabs[this.curTabIdx].turnBig(),this.highlight.x=this.curTabIdx*this.tabWidth},tabPressed:function(e){for(var t=0;t<this.tabs.length;++t){var n=this.tabs[t];n.idx===e?(n.turnBig(),cc.eventManager.pauseTarget(n.node)):this.curTabIdx===n.idx&&(n.turnSmall(),cc.eventManager.resumeTarget(n.node))}this.curTabIdx=e;var i=cc.moveTo(this.tabSwitchDuration,cc.v2(this.curTabIdx*this.tabWidth)).easing(cc.easeQuinticActionInOut());this.highlight.stopAllActions(),this.highlight.runAction(i),this.mainMenu.switchPanel(this.curTabIdx)}}),cc._RF.pop()},{}],Menu:[function(e,t){"use strict";cc._RF.push(t,"2fa38FRO0tA14rnZt9XBPST","Menu"),e("SelectLocalScreen"),cc.Class({extends:cc.Component,properties:{light:cc.Node,localBtn:cc.Node,computerBtn:cc.Node,soundBtn:cc.Node,musicBtn:cc.Node,soundSpriteFrame:[cc.SpriteFrame],musicSpriteFrame:[cc.SpriteFrame],selectLocalScreen:cc.Node,selectComputerScreen:cc.Node,playModeDia:cc.Node,newGameLayer:cc.Node,titleNode:cc.Node,playBtnNode:cc.Node,titleSFList:{default:[],type:cc.SpriteFrame},playSFList:{default:[],type:cc.SpriteFrame},langIconSfList:{default:[],type:cc.SpriteFrame},switchLangContainerNode:cc.Node,switchIconLang:cc.Node,switchLangLabel:cc.Label,labelLife:cc.Label,btnShop:cc.Node,nodeShop:cc.Node,warnDialogNode:cc.Node,btnOkOpenShop:cc.Node,warnTitleLb:cc.Label,warnContentLb:cc.Label},onLoad:function(){this.reloadUI(),this.updateLife(),this.playModeDia=this.playModeDia.getComponent("PlayModeDia"),this.newGameLayer=this.newGameLayer.getComponent("NewGame"),this.playModeDia.init(this.node),this.node.on("show-new-game",this.showNewGameLayer,this),this.light.active=!0,this.localBtn.on("click",this.onLocalBtnClicked,this),this.computerBtn.on("click",this.onComputerBtnClicked,this),this.soundBtn.on("click",this.onToggleSound,this),this.musicBtn.on("click",this.onToggleMusic,this)},onToggleMusic:function(){ddt.music=!ddt.music,this.musicBtn.getComponentInChildren(cc.Sprite).spriteFrame=this.musicSpriteFrame[Number(ddt.music)],console.log("ddt.music",ddt.music)},onToggleSound:function(){ddt.userData.sound=!ddt.userData.sound,this.soundBtn.getComponentInChildren(cc.Sprite).spriteFrame=this.soundSpriteFrame[Number(ddt.userData.sound)],console.log("ddt.userData.sound",ddt.userData.sound)},onLocalBtnClicked:function(){ddt.director=1,this.light.active=!1,this.node.active=!1,this.selectLocalScreen.active=!0},onComputerBtnClicked:function(){ddt.director=1,this.light.active=!1,this.node.active=!1,this.selectComputerScreen.active=!0},onShow:function(){this.node.position=cc.v2(1080*ddt.director,0),cc.tween(this.node).to(.2,{position:cc.v2(0,0)}).start()},onHide:function(e){this.node.position=cc.v2(0,0),cc.tween(this.node).to(.2,{position:cc.v2(-1080*ddt.director,0)}).call(e).start()},reloadUI:function(){this.titleNode.getComponent(cc.Sprite).spriteFrame=this.titleSFList[ddt.lang.localizeId()],this.playBtnNode.getComponent(cc.Sprite).spriteFrame=this.playSFList[ddt.lang.localizeId()],this.switchIconLang.getComponent(cc.Sprite).spriteFrame=this.langIconSfList[ddt.lang.localizeId()],this.switchLangLabel.string=ddt.lang.localize.label_lang},updateLife:function(){this.labelLife.string=ddt.userData.life+""},start:function(){},gotoGameBtnPressed:function(){ddt.userData.life<=0?this.showWarnDialog("You don't have enough turns.\nDo you want go to shop?"):ddt.userData.hasSavedGame()?this.playModeDia.show():this.node.emit("show-new-game")},signUpBtnPressed:function(){},signInBtnPressed:function(){},showHomeLayer:function(){this.node.active=!0,this.newGameLayer.hide(),this.light.active=!0},showNewGameLayer:function(){this.node.active=!1,this.newGameLayer.show(),this.light.active=!1},quitBtnPressed:function(){cc.game.end()},switchLangBtnPressed:function(){ddt.lang.switch(),this.reloadUI()},bannerBtnPressed:function(){},shopBtnPressed:function(){this.nodeShop.active=!0,this.nodeShop.emit("fade-in"),this.closeWarnDialog()},closeWarnDialog:function(){this.warnDialogNode.emit("fade-out")},showWarnDialog:function(e){this.warnDialogNode.active=!0,this.btnOkOpenShop.active=!0,this.warnTitleLb.string=ddt.lang.localize.label_dialog_title_warn,this.warnContentLb.string=e,this.warnDialogNode.emit("fade-in")}}),cc._RF.pop()},{SelectLocalScreen:"SelectLocalScreen"}],NetworkManager:[function(e,t){"use strict";cc._RF.push(t,"27dd8b3w4hEOr6mcqbqWlCS","NetworkManager");var n={METHOD:{GET:"GET",POST:"POST"},NetworkManager:{URL_START:"https://dev.gamee.vn/api/web/game/start",URL_END:"https://dev.gamee.vn/api/web/game/end",token:null,userId:null,gameCode:"LudoKing",eventId:null,matchId:null,timeStart:null,getInfoUser:function(){try{var e=document.cookie;e="_ga=GA1.2.1591179328.1732782019; _ga_X1YXCB9ZVR=GS1.2.1732782019.1.1.1732782276.0.0.0; user=%7B%22id%22%3A124%2C%22username%22%3A%22WZH_01HSTE6K73DCTP6YKP3WZX6QKG%22%2C%22displayName%22%3A%22Nguy%E1%BB%85n%20Th%E1%BB%8B%20H%E1%BA%A3i%20Y%E1%BA%BFn%22%2C%22email%22%3Anull%2C%22profilePicture%22%3Anull%2C%22coverPicture%22%3Anull%2C%22level%22%3Anull%2C%22experience%22%3Anull%2C%22isGoogleConnected%22%3Anull%2C%22isTelegramConnected%22%3Anull%2C%22isFacebookConnected%22%3Anull%2C%22isDiscordConnected%22%3Anull%2C%22isTwitchConnected%22%3Anull%2C%22isImmutablePassportConnected%22%3Anull%2C%22isTwitterConnected%22%3Anull%2C%22walletAddress%22%3Anull%2C%22walletAddressType%22%3Anull%2C%22enabled2FA%22%3Afalse%2C%22lastLoginTime%22%3A%222024-12-06T02%3A57%3A38.811336473%22%2C%22accessToken%22%3A%22eyJhbGciOiJIUzI1NiJ9.eyJpZCI6MTI0LCJ1c2VybmFtZSI6IldaSF8wMUhTVEU2SzczRENUUDZZS1AzV1pYNlFLRyIsImRpc3BsYXlOYW1lIjoiTmd1eeG7hW4gVGjhu4sgSOG6o2kgWeG6v24iLCJlbmFibGVkMkZBIjpmYWxzZSwibGFzdExvZ2luVGltZSI6IjIwMjQtMTItMDZUMDI6NTc6MzguODExMzM2NDczIiwicmVmZXJlbmNlQ29kZSI6Ijlmb1hkalc0QVBZNiIsImdlbmRlciI6IkZFTUFMRSIsInZ0bUFjY291bnRJZCI6IjAxSFNURTZLNzNEQ1RQNllLUDNXWlg2UUtHIiwic3ViIjoiMTI0IiwiaWF0IjoxNzMzNDUzODU4LCJleHAiOjE3NDIwOTM4NTh9.ZvbAxLnSpD-ZyXEZby0xqF7-R6_qOOXNYV5WY5Hmp8o%22%2C%22refreshToken%22%3A%22eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiIxMjQiLCJpYXQiOjE3MzM0NTM4NTgsImV4cCI6MTc0MjA5Mzg1OH0.Jm4xu-I_2kSFtLawUvgeox5IdbnwAACoi8Wr4LpWjuM%22%2C%22referenceCode%22%3A%229foXdjW4APY6%22%7D; token=eyJhbGciOiJIUzI1NiJ9.eyJpZCI6MTI0LCJ1c2VybmFtZSI6IldaSF8wMUhTVEU2SzczRENUUDZZS1AzV1pYNlFLRyIsImRpc3BsYXlOYW1lIjoiTmd1eeG7hW4gVGjhu4sgSOG6o2kgWeG6v24iLCJlbmFibGVkMkZBIjpmYWxzZSwibGFzdExvZ2luVGltZSI6IjIwMjQtMTItMDZUMDI6NTc6MzguODExMzM2NDczIiwicmVmZXJlbmNlQ29kZSI6Ijlmb1hkalc0QVBZNiIsImdlbmRlciI6IkZFTUFMRSIsInZ0bUFjY291bnRJZCI6IjAxSFNURTZLNzNEQ1RQNllLUDNXWlg2UUtHIiwic3ViIjoiMTI0IiwiaWF0IjoxNzMzNDUzODU4LCJleHAiOjE3NDIwOTM4NTh9.ZvbAxLnSpD-ZyXEZby0xqF7-R6_qOOXNYV5WY5Hmp8o; idGame=WordRumble; eventId=123";var t=(e=decodeURIComponent(e)).split(";"),n=t.find(function(e){return e.includes("user=")}).replace("user=",""),i=JSON.parse(n);this.token=i.accessToken,this.userId=i.id,this.eventId=t.find(function(e){return e.includes("eventId=")}),this.eventId&&(this.eventId=this.eventId.replace("eventId=",""),this.eventId=this.eventId.replace(" ",""))}catch(o){console.log("error get data: ",o)}},requestHttp:function(e,t,n,i){void 0===i&&(i=null);var o=new XMLHttpRequest;o.open(t,e,!0),o.setRequestHeader("Access-Control-Allow-Origin","*"),o.setRequestHeader("Content-type","application/json; charset=UTF-8"),o.setRequestHeader("Authorization","Bearer "+this.token),o.timeout=6e4,null!=n?o.send(JSON.stringify(n)):o.send(),o.onreadystatechange=function(){4==o.readyState&&o.status>=200&&o.status<400?i&&i(JSON.parse(o.response)):console.log("on request")}},callStartGameAPI:function(e){void 0===e&&(e=null),this.timeStart=(new Date).getTime(),this.matchId=this.userId+"-"+this.gameCode+"-"+this.timeStart;var t={matchId:this.matchId,gameCode:this.gameCode};this.requestHttp(this.URL_START,n.METHOD.POST,t,e)},callEndGameAPI:function(e,t){void 0===t&&(t=null);var i=((new Date).getTime()-this.timeStart)/1e3,o={matchId:this.matchId,gameCode:this.gameCode,token:this.token,score:e.score,playedSeconds:i,gameLevel:e.level,star:e.star,eventId:this.eventId};this.requestHttp(this.URL_END,n.METHOD.POST,o,t)}}};t.exports=n,cc._RF.pop()},{}],NewGame:[function(e,t){"use strict";cc._RF.push(t,"6b041yAof1IQLhvfzt5oj30","NewGame");var n=e("HorseSelection"),i=e("Config");cc.Class({extends:cc.Component,properties:{containerNode:cc.Node,funcContainerNode:cc.Node,autoRollingCb:cc.Toggle,autoMoveCb:cc.Toggle,soundCb:cc.Toggle,soundLb:cc.Label,players:{default:[],type:[n]},coms:{default:[],type:[n]},warnDialogNode:cc.Node,btnOkOpenShop:cc.Node,warnTitleLb:cc.Label,warnContentLb:cc.Label,clickEffect:cc.AudioSource,backBtnNode:cc.Node,doneBtnNode:cc.Node,backSfList:{default:[],type:cc.SpriteFrame},doneSfList:{default:[],type:cc.SpriteFrame},labelPlayer:cc.Label,labelAI:cc.Label,labelOtherSetting:cc.Label,labelAutoMove:cc.Label,labelAutoDicing:cc.Label},init:function(e){this.homeNode=e,this.done=!1},onLoad:function(){var e=cc.winSize;e.height/e.width<1.4&&(this.containerNode.scale=.85,this.funcContainerNode.scale=.85)},show:function(){this.backBtnNode.getComponent(cc.Sprite).spriteFrame=this.backSfList[ddt.lang.localizeId()],this.doneBtnNode.getComponent(cc.Sprite).spriteFrame=this.doneSfList[ddt.lang.localizeId()],this.soundLb.string=ddt.userData.sound?ddt.lang.localize.sound_on:ddt.lang.localize.sound_off,this.labelPlayer.string=ddt.lang.localize.label_player,this.labelAI.string=ddt.lang.localize.label_ai,this.labelOtherSetting.string=ddt.lang.localize.label_other_setting,this.labelAutoMove.string=ddt.lang.localize.label_auto_move,this.labelAutoDicing.string=ddt.lang.localize.label_auto_dicing,this.node.active=!0},hide:function(){this.node.active=!1},soundChange:function(){var e=this.soundCb.isChecked;ddt.userData.saveSound(e),this.soundLb.string=e?ddt.lang.localize.sound_on:ddt.lang.localize.sound_off},doneBtnPressed:function(){if(!this.done){var e=[],t=!1;for(var n in this.players){var o=this.players[n];o.isSelected()&&(e.push(o),t=!0)}if(t){for(var n in this.coms){var r=this.coms[n];r.isSelected()&&e.push(r)}e.length<2?this.showWarnDialog(ddt.lang.localize.warn_not_enough_players):(this.done=!0,ddt.userData.saveAutoDice(this.autoRollingCb.isChecked),ddt.userData.saveAutoMove(this.autoMoveCb.isChecked),ddt.userData.saveSound(this.soundCb.isChecked),ddt.assetHelper.loadInGameAsset(function(){cc.director.loadScene("game-play-1",function(){var t=cc.director.getScene().getChildByName("Canvas").getComponent("GamePlay"),n=new i;for(var o in n.autoDice=!0,n.autoMove=!0,n.sound=ddt.userData.sound,console.log("members",e),console.log("config.players",n.players),e){var r=e[o];for(var a in n.players){var s=n.players[a];s.id==r.id&&(s.isHuman=r.isHuman,s.type=r.isHuman?ddt.PlayerType.Human:ddt.PlayerType.AI,s.active=!0)}}t.config=n})}))}else this.showWarnDialog(ddt.lang.localize.warn_no_human)}},closeWarnDialog:function(){this.warnDialogNode.emit("fade-out")},showWarnDialog:function(e){this.warnDialogNode.active=!0,this.warnTitleLb.string=ddt.lang.localize.label_dialog_title_warn,this.warnContentLb.string=e,this.warnDialogNode.emit("fade-in")},playClick:function(){ddt.userData.sound&&this.clickEffect.play()}}),cc._RF.pop()},{Config:"Config",HorseSelection:"HorseSelection"}],NotTurnPopup:[function(e,t){"use strict";cc._RF.push(t,"3872dyIH41LAq0J+nWOdqQG","NotTurnPopup"),cc.Class({extends:cc.Component,properties:{okBtn:cc.Node,popupNode:cc.Node},onLoad:function(){var e=this;this.node.active=!1,this.okBtn.on("click",function(){return e.onHide(function(){return e.node.active=!1})},this)},onEnable:function(){this.popupNode.scale=.1,cc.tween(this.popupNode).to(.2,{scale:2}).start()},onHide:function(e){this.popupNode.scale=1,cc.tween(this.popupNode).to(.2,{scale:.1}).call(e).start()}}),cc._RF.pop()},{}],PanelTransition:[function(e,t){"use strict";cc._RF.push(t,"f7884o9G6tP67Tm7JhKuQtr","PanelTransition"),cc.Class({extends:cc.Component,properties:{duration:0},onLoad:function(){this.outOfWorld=cc.v2(3e3,0),this.node.position=this.outOfWorld;var e=cc.callFunc(this.onFadeOutFinish,this),t=cc.callFunc(this.onFadeInFinish,this);this.actionFadeIn=cc.sequence(cc.spawn(cc.fadeTo(this.duration,255),cc.scaleTo(this.duration,1)),t),this.actionFadeOut=cc.sequence(cc.spawn(cc.fadeTo(this.duration,0),cc.scaleTo(this.duration,2)),e),this.node.on("fade-in",this.startFadeIn,this),this.node.on("fade-out",this.startFadeOut,this)},startFadeIn:function(){cc.eventManager.pauseTarget(this.node,!0),this.node.position=cc.v2(0,0),this.node.setScale(2),this.node.opacity=0,this.node.runAction(this.actionFadeIn)},startFadeOut:function(){cc.eventManager.pauseTarget(this.node,!0),this.node.runAction(this.actionFadeOut)},onFadeInFinish:function(){cc.eventManager.resumeTarget(this.node,!0)},onFadeOutFinish:function(){this.node.position=this.outOfWorld,this.node.active=!1}}),cc._RF.pop()},{}],PauseLayer:[function(e,t){"use strict";cc._RF.push(t,"9dc0aF74w1CLL4EO2mCyCKe","PauseLayer"),cc.Class({extends:cc.Component,properties:{continuesBtnNode:cc.Node,exitBtnNode:cc.Node,continuesSfList:{default:[],type:cc.SpriteFrame},exitSfList:{default:[],type:cc.SpriteFrame}},onLoad:function(){},show:function(){this.continuesBtnNode.getComponent(cc.Sprite).spriteFrame=this.continuesSfList[ddt.lang.localizeId()],this.exitBtnNode.getComponent(cc.Sprite).spriteFrame=this.exitSfList[ddt.lang.localizeId()],this.node.active=!0,this.node.emit("fade-in")}}),cc._RF.pop()},{}],PausePopup:[function(e,t){"use strict";cc._RF.push(t,"849d4zJyaNOL7yLSAOBHjfV","PausePopup"),cc.Class({extends:cc.Component,properties:{worldNode:cc.Node,popupNode:cc.Node,_world:null},onLoad:function(){this.node.active=!1;var e=this.node.getComponentsInChildren(cc.Button),t=e[0],n=e[1];t.node.on("click",this.onOkBtnClick,this),n.node.on("click",this.onCancelBtnClick,this),this._world=this.worldNode.getComponent("World")},onEnable:function(){this.popupNode.scale=.1,cc.tween(this.popupNode).to(.2,{scale:1}).start()},onOkBtnClick:function(){this.onHide(cc.director.loadScene("menu"))},onCancelBtnClick:function(){this.onHide(),this._world.fsm.resume()},onHide:function(e){var t=this;this.popupNode.scale=1,cc.tween(this.popupNode).to(.2,{scale:.1}).call(function(){return t.node.active=!1}).call(e).start()}}),cc._RF.pop()},{}],PlaceHolder:[function(e,t){"use strict";cc._RF.push(t,"45b3cE03b9EjoKZRKa512tk","PlaceHolder");var n=e("Types").PlaceType,i=e("Types").PlayerID,o=cc.Class({name:"PlaceHolder",properties:{index:{default:0,type:cc.Integer},location:cc.Vec2,placeType:{default:n.Point,type:n},areaType:{default:i.Red,type:i},view:1},onLoad:function(){this.horse=null,this.nextPlaceHoder=null,this.prevPlace=null}});t.exports=o,cc._RF.pop()},{Types:"Types"}],PlayModeDia:[function(e,t){"use strict";cc._RF.push(t,"b963dacXkVGM7PSmwm2m09a","PlayModeDia");var n=e("async"),i=e("Config");cc.Class({extends:cc.Component,properties:{homeNode:cc.Node,continuesBtnNode:cc.Node,newGameBtnNode:cc.Node,contiuesSfList:{default:[],type:cc.SpriteFrame},newGameSfList:{default:[],type:cc.SpriteFrame}},init:function(e){this.parentNode=e},onLoad:function(){},show:function(){this.continuesBtnNode.getComponent(cc.Sprite).spriteFrame=this.contiuesSfList[ddt.lang.localizeId()],this.newGameBtnNode.getComponent(cc.Sprite).spriteFrame=this.newGameSfList[ddt.lang.localizeId()],this.node.active=!0,this.node.emit("fade-in"),cc.eventManager.pauseTarget(this.parentNode)},hide:function(){this.node.emit("fade-out"),cc.eventManager.resumeTarget(this.parentNode)},newGameBtnPressed:function(){ddt.userData.clearSavedGame(),this.node.emit("fade-out"),this.homeNode.emit("show-new-game")},continuesBtnPressed:function(){n.waterfall([function(e){ddt.userData.loadSavedGame(function(t,n){console.log("Loaded saved_game flag: "+t),t||e("error"),ddt.userData.clearSavedGame(),e(null,n)})},function(e,t){cc.director.preloadScene("game-play",function(){t(null,e)})},function(e,t){cc.director.loadScene("game-play",function(){t(null,e)})}],function(e,t){if(!e){var n=cc.director.getScene().getChildByName("Canvas").getComponent("GamePlay"),o=new i;for(var r in o.players){var a,s=o.players[r];for(var c in t.players)if((a=t.players[c]).id==s.id)break;for(var c in s.type=a.type,s.active=a.active,s.horses){var l=s.horses[c],d=a.horses[c];l.index=d.index,l.placeType=d.placeType}}o.playerTurn=t.turn,n.config=o}})}}),cc._RF.pop()},{Config:"Config",async:2}],Player:[function(e,t){"use strict";cc._RF.push(t,"fcbc9aBj7hJUbZj8sCLZtoK","Player"),e("Horse");var n=e("Dice"),i=e("Types").PlayerID,o=e("Roller"),r=e("PlaceHolder");cc.Class({extends:cc.Component,properties:{horseSprite:cc.SpriteFrame,horses:{default:[],type:e("Horse"),visible:!1},dices:{default:[],type:[n]},stablePlaces:{default:[],type:r},tower:{default:[],type:r},diceTouchArea:cc.rect,roller:o,renderSprite:cc.Sprite,worldNode:cc.Node,horsePrefab:cc.v2refab,id:{default:i.Red,type:i},isHuman:!1,horseAsset:"",luckyLevel:{default:e("Types").LuckyLevel.Normal,type:e("Types").LuckyLevel},stableArea:{default:new cc.Rect}},init:function(e){for(var t in this.world=e,this.roller.init(this),this.in=null,this.out=null,this.suggestMoves=null,this.tower){var n=this.tower[t];switch(this.id){case ddt.PlayerID.Yellow:case ddt.PlayerID.Green:n.view=-1;break;default:n.view=1}}var o=cc.v2(0,0);for(o.x=this.stableArea.x+this.stableArea.width/2,o.y=this.stableArea.y+this.stableArea.height/2,t=0;t<4;t++){var a,s;switch((n=new r).placeType=ddt.PlaceType.Stable,n.areaType=this.id,t){case 0:a=o.x-73,s=o.y+70;break;case 1:a=o.x-73,s=o.y-70;break;case 2:a=o.x+73,s=o.y-70;break;default:a=o.x+73,s=o.y+70}switch(n.location=cc.v2(a,s),this.id){case ddt.PlayerID.Yellow:case ddt.PlayerID.Red:n.view=-1;break;default:n.view=1}this.stablePlaces.push(n)}for(var c in this.stablePlaces){n=this.stablePlaces[c];var l=cc.instantiate(this.horsePrefab);ddt.horseNodes.push(l),this.worldNode.addChild(l);var d=l.getComponent("Horse");d.init(this,n,this.horseSprite),d.id=c,d.returnStable(),this.horses.push(d)}for(var c in this.dices){var u=this.dices[c];switch(u.node.zIndex=this.world.dice_z,u.rollingLocation=o,this.id){case ddt.PlayerID.Red:case ddt.PlayerID.Blue:u.restingLocation=cc.v2(o.x,this.stableArea.y+this.stableArea.height+60);break;case ddt.PlayerID.Yellow:case ddt.PlayerID.Green:u.restingLocation=cc.v2(o.x,this.stableArea.y-60)}u.node.setPosition(o)}this.dices[0].use=!0,this.dices[1].use=!1;for(var h=this.tower.length,p=0;p<h-1;p++){var f=p+1,y=this.tower[p],m=this.tower[f];y.nextPlaceHoder=m}var g="";switch(this.id){case i.Red:g=ddt.asset.horse_red;break;case i.Yellow:g=ddt.asset.horse_yellow;break;case i.Green:g=ddt.asset.horse_green;break;case i.Blue:g=ddt.asset.horse_blue}this.horseAsset=g},prepare:function(e){for(var t in this.isHuman=e.type==ddt.PlayerType.Human,this.tower)this.tower[t].horse=null;2==e.numDices?(this.dices[0].use=!0,this.dices[1].use=!0):(this.dices[0].use=!0,this.dices[1].use=!1);var n=this.worldNode.getComponent("World");for(var i in this.horses){var o=e.horses[i],r=this.horses[i];o.placeType==ddt.PlaceType.Stable?r.setCurrentPlace(this.stablePlaces[i]):o.placeType==ddt.PlaceType.Fame?r.setCurrentPlace(this.tower[o.index]):r.setCurrentPlace(n.roadMap[o.index]),r.currentPlace.horse=r,r.node.getComponent("HorseState").enabled=!0,r.renderNode.getComponent(cc.Sprite).spriteFrame=ddt.assetHelper.getHorseSpriteFrame(this.horseAsset,ddt.asset.emotion_smile,0)}this.isHuman||null==this.node.getComponent("AIMove")&&this.node.addComponent("AIMove"),this.skin()},skin:function(){var e=this.horses;for(var t in e){var n=e[t],i=n.renderNode,o=ddt.asset.emotion_smile;n.state!=ddt.HorseState.TopFame&&n.state!=ddt.HorseState.OnFame||(o=ddt.asset.emotion_happy),i.getComponent(cc.Sprite).spriteFrame=ddt.assetHelper.getHorseSpriteFrame(this.horseAsset,o,0)}},reskin:function(){this.skin()},isActive:function(){return this.node.active},activate:function(){this.setVisible(!0)},deactive:function(){this.setVisible(!1)},setVisible:function(e){this.node.active=e;var t,n=this.horses;for(t in n)n[t].node.active=e},showDice:function(){var e;for(e in this.dices){var t=this.dices[e];t.use&&(t.reset(),t.changeFaceDice(),t.activate())}},hideDice:function(){var e;for(e in this.dices)this.dices[e].deactive()},changeFaceDice:function(){var e;for(e in this.dices){var t=this.dices[e];t.use&&t.changeFaceDice()}},showFaceDiceResult:function(){var e;for(e in this.dices){var t=this.dices[e];t.use&&t.showResult()}},getDiceFaceNumber:function(){var e=[];for(var t in this.dices){var n=this.dices[t];n.use&&e.push(n.number)}return e},resetDices:function(){for(var e in this.dices)this.dices[e].number=0},moveDiceToRecting:function(e,t){var n=!1;for(var i in this.dices){var o=this.dices[i];o.use&&(o.moveToRestingLoc(e,n?null:t),n=!0)}},moveDiceToRolling:function(e,t){var n=!1;for(var i in this.dices){var o=this.dices[i];o.use&&(o.moveToRollingLoc(e,n?null:t),n=!0)}}}),cc._RF.pop()},{Dice:"Dice",Horse:"Horse",PlaceHolder:"PlaceHolder",Roller:"Roller",Types:"Types"}],RenderOrder:[function(e,t){"use strict";cc._RF.push(t,"0ed9cZzeiJJ9IBBR6yOtS5E","RenderOrder"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.node.on(ddt.event.local_world_reoder,this.reoder,this)},reoder:function(){var e=this.node.getComponent("World"),t=[];for(var n in e.players){var i=e.players[n];t=t.concat(i.horses)}for(var n in t.sort(function(e,t){var n=e.currentPlace.placeType,i=e.currentPlace.placeType,o=e.currentPlace.location,r=t.currentPlace.location;if(n!=i){if(n==ddt.PlaceType.Fame)return!1;if(i==ddt.PlaceType.Fame)return!0;if(n==ddt.PlaceType.Stable)return!0;if(i==ddt.PlaceType.Stable)return!1}return!(o.y>r.y||!(o.y<r.y)&&o.x>r.x)}),t){var o=t[n];o.node.setScale(o.currentPlace.view,1)}}}),cc._RF.pop()},{}],Roller:[function(e,t){"use strict";cc._RF.push(t,"0d814KHU3hP7r7xWwR5fYCK","Roller");var n=cc.Class({name:"Roller",properties:{count:0},init:function(e){this.player=e},roll:function(){cc.log("rolling....");var e=this.player.dices,t=0;for(t in e){var n,i=e[t];if(i.use){switch(this.player.luckyLevel){case ddt.LuckyLevel.Best:n=6;break;case ddt.LuckyLevel.Worse:n=1;break;default:n=Math.floor(6*Math.random())+1}i.number=n,this.count++,cc.log("Rolled number: "+n)}}},getTotalStep:function(){var e=0,t=this.player.dices;for(var n in t){var i=t[n];i.use&&(e+=i.number)}return e}});t.exports=n,cc._RF.pop()},{}],SelectComputerScreen:[function(e,t){"use strict";cc._RF.push(t,"9a419fvUJhFMrd+5hdKa60w","SelectComputerScreen"),cc.Class({extends:cc.Component,properties:{toggleContainerPlayerTotal:cc.ToggleContainer,backBtn:cc.Node,nextBtn:cc.Node,selectPositionScreen:cc.Node,homeScreen:cc.Node},onLoad:function(){var e=this;this.node.active=!1,this.toggleContainerPlayerTotal.node.children.forEach(function(t){t.on("toggle",e.onTogglePlayerTotalClicked,e)}),this.backBtn.on("click",this.onBackClicked,this),this.nextBtn.on("click",this.onNextClicked,this),ddt.playerTotal=0},onEnable:function(){this.onShow()},onTogglePlayerTotalClicked:function(e){ddt.playerTotal=e.node.getSiblingIndex()},onBackClicked:function(){var e=this;ddt.director=-1,this.onHide(function(){e.node.active=!1,e.homeScreen.active=!0})},onNextClicked:function(){var e=this;ddt.director=1,this.onHide(function(){e.node.active=!1,e.selectPositionScreen.active=!0})},onShow:function(){this.node.position=cc.v2(1080*ddt.director,0),cc.tween(this.node).to(.2,{position:cc.v2(0,0)}).start()},onHide:function(e){this.node.position=cc.v2(0,0),cc.tween(this.node).to(.2,{position:cc.v2(-1080*ddt.director,0)}).call(e).start()}}),cc._RF.pop()},{}],SelectLocalScreen:[function(e,t){"use strict";function n(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=i(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}cc._RF.push(t,"aaf2ajOFqxNlZ4hcFW2XXQI","SelectLocalScreen");var r=e("Config");cc.Class({extends:cc.Component,properties:{toggleContainerColor:cc.ToggleContainer,toggleContainerPlayerTotal:cc.ToggleContainer,backBtn:cc.Node,nextBtn:cc.Node,newGameScreen:cc.Node,homeScreen:cc.Node,loadingScreen:cc.Node,playerTotal:cc.Float,playerIndex:cc.Float},onLoad:function(){var e=this;this.node.active=!1,this.playerTotal=2,this.playerIndex=0,this.toggleContainerColor.node.children.forEach(function(t,n){t.on("toggle",e.onToggleColorClicked,e),t.active=n<=e.playerTotal+1}),this.toggleContainerPlayerTotal.node.children.forEach(function(t){t.on("toggle",e.onTogglePlayerTotalClicked,e)}),this.backBtn.on("click",this.onBackClicked,this),this.nextBtn.on("click",this.onNextClicked,this)},onEnable:function(){this.setTogglePlayerColor(),this.onShow()},setTogglePlayerColor:function(e){var t=this;void 0===e&&(e=0),this.playerIndex=e,this.toggleContainerColor.node.children.forEach(function(e,n){e.active=n<=t.playerTotal+1,e.isChecked=n==t.playerIndex,e.children[1].active=n==t.playerIndex})},onToggleColorClicked:function(e){this.playerIndex=e.node.getSiblingIndex(),this.setTogglePlayerColor(this.playerIndex)},onTogglePlayerTotalClicked:function(e){this.playerTotal=e.node.getSiblingIndex(),this.setTogglePlayerColor()},onBackClicked:function(){var e=this;ddt.director=-1,this.onHide(function(){e.node.active=!1,e.homeScreen.active=!0})},onNextClicked:function(){var e=this;ddt.isComputer=!1,ddt.director=1;var t=[{id:0},{id:1},{id:2},{id:3}],i=t.filter(function(t,n){return n<=e.playerTotal+1});0==this.playerTotal&&(i=[t[0],t[2]]),this.loadingScreen.active=!0;var o=new r;o.autoMove=!0,o.autoDice=!1,o.sound=ddt.userData.sound,ddt.humanId=this.playerIndex;for(var a,s=n(i);!(a=s()).done;){var c=a.value;o.players[c.id].active=!0,o.players[c.id].isHuman=!0,o.players[c.id].type=ddt.PlayerType.Human}ddt.assetHelper.loadInGameAsset(function(){e.onHide(function(){cc.director.loadScene("game-play",function(){cc.director.getScene().getChildByName("Canvas").getComponent("GamePlay").config=o})})})},onShow:function(){this.node.position=cc.v2(1080*ddt.director,0),cc.tween(this.node).to(.2,{position:cc.v2(0,0)}).start()},onHide:function(e){this.node.position=cc.v2(0,0),cc.tween(this.node).to(.2,{position:cc.v2(-1080*ddt.director,0)}).call(e).start()}}),cc._RF.pop()},{Config:"Config"}],SelectPositionScreen:[function(e,t){"use strict";function n(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=i(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}cc._RF.push(t,"3021dhzKORNkZUTnSsZIEPS","SelectPositionScreen");var r=e("Config"),a=e("NetworkManager");cc.Class({extends:cc.Component,properties:{toggleContainerSelectPosition:cc.ToggleContainer,backBtn:cc.Node,nextBtn:cc.Node,selectComputerScreen:cc.Node,loadingScreen:cc.Node,notTurnPopup:cc.Node,playerIndex:cc.Float,messagePopup:cc.Label},onLoad:function(){var e=this;this.node.active=!1,this.toggleContainerSelectPosition.node.children.forEach(function(t){t.on("toggle",e.onTogglePlayerTotalClicked,e)}),this.backBtn.on("click",this.onBackClicked,this),this.nextBtn.on("click",this.onNextClicked,this),this.playerIndex=2},onEnable:function(){this.onShow()},onTogglePlayerTotalClicked:function(e){this.playerIndex=[2,1,3,0][e.node.getSiblingIndex()]},onBackClicked:function(){var e=this;ddt.director=-1,this.onHide(function(){e.node.active=!1,e.selectComputerScreen.active=!0})},onNextClicked:function(){var e=this;this.loadingScreen.active=!0,ddt.stepsTotal=[0,0,0,0],a.NetworkManager.getInfoUser(),a.NetworkManager.callStartGameAPI(function(t){return t.code,void e.startGame()})},startGame:function(){var e=this;ddt.director=1;var t=[{id:0},{id:1},{id:2},{id:3}],i=t.filter(function(t){return t.id!=e.playerIndex}),o=[t[this.playerIndex]].concat(i.slice(0,ddt.playerTotal+1));0==ddt.playerTotal&&(o=[t[this.playerIndex],t[(this.playerIndex+2)%4]]);var a=new r;a.autoDice=!1,a.autoMove=!0,a.sound=ddt.userData.sound;for(var s,c=n(o);!(s=c()).done;){var l=s.value;a.players[l.id].active=!0,a.players[l.id].isHuman=l.id==this.playerIndex,a.players[l.id].type=l.id==this.playerIndex?ddt.PlayerType.Human:ddt.PlayerType.AI}ddt.isComputer=!0,ddt.humanId=this.playerIndex,ddt.assetHelper.loadInGameAsset(function(){return e.onHide(function(){cc.director.loadScene("game-play",function(){cc.director.getScene().getChildByName("Canvas").getComponent("GamePlay").config=a})})})},onShow:function(){this.node.position=cc.v2(1080*ddt.director,0),cc.tween(this.node).to(.2,{position:cc.v2(0,0)}).start()},onHide:function(e){this.node.position=cc.v2(0,0),cc.tween(this.node).to(.2,{position:cc.v2(-1080*ddt.director,0)}).call(e).start()}}),cc._RF.pop()},{Config:"Config",NetworkManager:"NetworkManager"}],ShopLayer:[function(e,t){"use strict";cc._RF.push(t,"55c442u2SBBO4NjZP8bhBDe","ShopLayer"),cc.Class({extends:cc.Component,properties:{blueTeamLabel:cc.Label,greenTeamLabel:cc.Label,yellowTeamLabel:cc.Label,redTeamLabel:cc.Label,tableTitleLabel:cc.Label,soundTitleLabel:cc.Label,backBtnNode:cc.Node,backSfList:{default:[],type:cc.SpriteFrame}},onLoad:function(){},show:function(){this.backBtnNode.getComponent(cc.Sprite).spriteFrame=this.backSfList[ddt.lang.localizeId()],this.blueTeamLabel.string=ddt.lang.localize.team_blue_name,this.greenTeamLabel.string=ddt.lang.localize.team_green_name,this.yellowTeamLabel.string=ddt.lang.localize.team_yellow_name,this.redTeamLabel.string=ddt.lang.localize.team_red_name,this.tableTitleLabel.string=ddt.lang.localize.label_shop_title_table,this.soundTitleLabel.string=ddt.lang.localize.label_shop_title_sound,this.node.active=!0,this.node.getComponent(cc.Animation).play("shop-slide-in")}}),cc._RF.pop()},{}],ShopUI2:[function(e,t){"use strict";cc._RF.push(t,"d7604wsd8ZA4a637mbrE9hC","ShopUI2");var n=null,i=[{id:"park_1",value:5,cost:"0.99$"},{id:"park_2",value:510,cost:"49.99$"},{id:"park_3",value:1050,cost:"99.99$"}],o=[];cc.Class({extends:cc.Component,properties:{list_sf_item:[],item_shop_prefab:cc.Prefab,scroll_shop:cc.ScrollView,nodeMenu:cc.Node},onLoad:function(){n=this},start:function(){this.nodeMenu=this.nodeMenu.getComponent("Menu"),this.loadShop(),FBInstant.payments.onReady(function(){console.log("Payments Ready!"),FBInstant.payments.getCatalogAsync().then(function(e){console.log("-=-=-=-=-=-=-=IAP_CONFIG 0"),console.log(e),i=[];for(var t=0;t<e.length;t++){console.log("-=-=-=-=-=-=-=IAP_CONFIG iiii"),console.log(e[t]);var o=e[t].description;i.push({id:e[t].productID,value:parseInt(o),cost:e[t].price})}console.log("-=-=-=-=-=-=-=IAP_CONFIG"),console.log(i),n.loadShop()}).catch(function(e){console.log("-=-=-=-= ERROR  ",e)})})},loadShop:function(){var e=i;e.sort(function(e,t){return e.value-t.value});for(var t=0;t<e.length;t++){var n=null;t<o.length?(n=o[t]).node.active=!0:((n=cc.instantiate(this.item_shop_prefab).getComponent("ItemShop")).node.parent=this.scroll_shop.content,o.push(n)),n.node.indexItem=t,n.node.data=e[t],n.setInfo(e[t].cost,e[t].value);var r=new cc.Component.EventHandler;r.target=this,r.component="ShopUI2",r.handler="onClickItemShop",n.node.getComponent(cc.Button).clickEvents=[r]}for(var a=e.length;a<o.length;a++)o[a].node.active=!1},onClickItemShop:function(e){var t=e.target;console.log("-=-=-=CLICK"),console.log(t);var n=t.data;console.log(n),console.log("-=-=-=-= ID IAP:   "+n.id),cc.sys.isNative||FBInstant.payments.purchaseAsync({productID:n.id,developerPayload:"foobar"}).then(function(e){console.log("----------------Handling a purchase   "),console.log(e);for(var t=i,n=0;n<t.length;n++)if(console.log("-=-= ID "+t[n].id),e.productID===t[n].id){var o=ddt.userData.life;ddt.userData.life=o+t[n].value,nodeMenu.updateLife();break}}).catch(function(e){console.log("-=-=-=-= ERROR  ",e)})},closeClick:function(){this.node.emit("fade-out")}}),cc._RF.pop()},{}],SmartButton:[function(e,t){"use strict";cc._RF.push(t,"02253+cK21HpqueDwXSegqD","SmartButton"),cc.Class({extends:cc.Button,properties:{clickEffect:cc.AudioSource},onLoad:function(){var e=this;this.node.on(cc.Node.EventType.TOUCH_START,function(){cc.log("This is a callback after the trigger event"),ddt.userData.sound&&e.clickEffect.play()})}}),cc._RF.pop()},{}],SoundEffect:[function(e,t){"use strict";cc._RF.push(t,"e6d9diEVVJDK6JJ9nj4LgKV","SoundEffect"),cc.Class({extends:cc.Component,properties:{classicEffects:{default:null,type:cc.AudioClip},forestEffects:{default:null,type:cc.AudioClip},beachEffects:{default:null,type:cc.AudioClip},streetEffects:{default:null,type:cc.AudioClip},marsEffects:{default:null,type:cc.AudioClip},horseMoveEffect:{default:null,type:cc.AudioClip},dicingEffect:{default:null,type:cc.AudioClip}},onLoad:function(){this.effects={},this.effects[ddt.asset.skin_classic]=this.classicEffects,this.effects[ddt.asset.skin_forest]=this.forestEffects,this.effects[ddt.asset.skin_beach]=this.beachEffects,this.effects[ddt.asset.skin_street]=this.streetEffects,this.effects[ddt.asset.skin_mars]=this.marsEffects,this.node.on(ddt.event.local_world_kick,this.onPlayerKickEnemyHorse,this),this.node.on(ddt.event.local_world_promotion,this.onHorsePromotion,this),this.node.on(ddt.event.local_world_horse_move,this.onHorseMoveStepByStep,this),this.node.on(ddt.event.local_world_export_horse,this.onPlayerExportHorse,this),this.node.on(ddt.event.local_world_good_rolling,this.onPlayerRollGoodDice,this),this.node.on(ddt.event.local_world_no_move,this.onPlayerNoMove,this),this.node.on(ddt.event.local_world_win,this.onPlayerWin,this),this.node.on(ddt.event.local_world_dicing,this.onDicing,this)},playEffect:function(e){if(ddt.userData.sound){var t,n=this.effects[ddt.userData.soundType];e==ddt.asset.sound_be_kicked?t=n[0]:e==ddt.asset.sound_export?t=n[1]:e==ddt.asset.sound_good_dice?t=n[2]:e==ddt.asset.sound_kick?t=n[3]:e==ddt.asset.sound_no_move?t=n[4]:e==ddt.asset.sound_promotion?t=n[5]:e==ddt.asset.sound_win&&(t=n[6]),cc.audioEngine.playEffect(t)}},onPlayerKickEnemyHorse:function(){this.playEffect(ddt.asset.sound_kick)},onPlayerExportHorse:function(){this.playEffect(ddt.asset.sound_export)},onPlayerRollGoodDice:function(){this.playEffect(ddt.asset.sound_good_dice)},onPlayerNoMove:function(){this.playEffect(ddt.asset.sound_no_move)},onHorseMoveStepByStep:function(){ddt.userData.sound&&cc.audioEngine.playEffect(this.horseMoveEffect)},onDicing:function(){ddt.userData.sound&&cc.audioEngine.playEffect(this.dicingEffect)},onHorsePromotion:function(){this.playEffect(ddt.asset.sound_promotion)},onPlayerWin:function(){this.playEffect(ddt.asset.sound_win)}}),cc._RF.pop()},{}],SoundTypeSelection:[function(e,t){"use strict";cc._RF.push(t,"78dcbqmPMRMTracPJDvIY8d","SoundTypeSelection");var n=e("SoundType");cc.Class({extends:cc.Component,properties:{soundTypes:{default:[],type:n},titleNode:cc.Node},onLoad:function(){},selectSoundType:function(){}}),cc._RF.pop()},{SoundType:"SoundType"}],SoundType:[function(e,t){"use strict";cc._RF.push(t,"7d6afwyGSJIG4onA92681Rr","SoundType"),cc.Class({extends:cc.Component,properties:{sprite:cc.Node},onLoad:function(){},click:function(){}}),cc._RF.pop()},{}],Splash:[function(e,t){"use strict";cc._RF.push(t,"3aaf5DriTRBIYelLxto7eVF","Splash"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){},start:function(){cc.director.preloadScene("menu",function(){cc.director.loadScene("menu")})}}),cc._RF.pop()},{}],StatisContent:[function(e,t){"use strict";cc._RF.push(t,"34f2ajsRJpCMKF5tVyiWtOJ","StatisContent"),cc.Class({extends:cc.Component,properties:{tabBar:e("MenuSidebar"),dialogTitleLb:cc.Label,winsTitleLb:cc.Label,kicksTitleLb:cc.Label},onLoad:function(){this.tabBar.init(this)},onEnable:function(){this.dialogTitleLb.string=ddt.lang.localize.label_statis_title_dialog,this.winsTitleLb.string=ddt.lang.localize.label_statis_title_win+" "+ddt.userData.wins,this.kicksTitleLb.string=ddt.lang.localize.label_statis_title_kick+" "+ddt.userData.kicks},switchPanel:function(){}}),cc._RF.pop()},{MenuSidebar:"MenuSidebar"}],TabCtrl:[function(e,t){"use strict";cc._RF.push(t,"49ec9n+o0hCFpE+pSLvIMHQ","TabCtrl"),cc.Class({extends:cc.Component,properties:{idx:0,dividerNode:cc.Node,icon:cc.Sprite,anim:cc.Animation},init:function(e){this.sidebar=e.sidebar,this.idx=e.idx,this.icon.spriteFrame=e.iconSF,this.node.on("touchstart",this.onPressed.bind(this),this.node)},onPressed:function(){this.sidebar.tabPressed(this.idx)},turnBig:function(){this.anim.play("tab_turnbig")},turnSmall:function(){this.anim.play("tab_turnsmall")}}),cc._RF.pop()},{}],TableSkinSelection:[function(e,t){"use strict";cc._RF.push(t,"0cfdctFHIlK+KRz0FlmQ9Q6","TableSkinSelection");var n=e("TableSkin");cc.Class({extends:cc.Component,properties:{titleLb:cc.Node,tableSkins:{default:[],type:n}},onLoad:function(){},selectTableSkin:function(){},reset:function(){}}),cc._RF.pop()},{TableSkin:"TableSkin"}],TableSkin:[function(e,t){"use strict";cc._RF.push(t,"7aa9bNDuyBGT7ypwX7oPoUj","TableSkin"),cc.Class({extends:cc.Component,properties:{sprite:cc.Node,tableSkin:"",backgroundType:"",parentNode:cc.Node},onLoad:function(){},click:function(){ddt.userData.backgroundType=this.backgroundType,ddt.userData.tableSkin=this.tableSkin}}),cc._RF.pop()},{}],TestPlay:[function(e,t){"use strict";cc._RF.push(t,"0c9432QEWlGSYBjux32FL2q","TestPlay");var n=e("WorldStateFactory"),i=e("Config"),o=cc.Class({name:"TestPlay",init:function(e){this.world=e,this._testLogic=!1},isTestLogic:function(){return this._testLogic},setupPreference:function(){var e=new n.WorldStateFactory;if(e.init(this.world),ddt.userData.autoDice){var t=new n.AutoDiceWorldStateFactory;t.init(e),e=t}if(ddt.userData.autoMove){var i=new n.AutoMoveWorldStateFactory;i.init(e),e=i}this.world.stateFactory=e},test2HummanPlayers:function(){var e=new i,t=e.players;return t[0].type=ddt.PlayerType.Human,t[1].type=ddt.PlayerType.AI,t[2].type=ddt.PlayerType.AI,t[3].type=ddt.PlayerType.Human,t[0].active=!0,t[1].active=!1,t[2].active=!1,t[3].active=!0,e},test2HummanPlayersWithLuckyPlayer:function(){var e=new i;ddt.userData.autoDice=!1,ddt.userData.autoMove=!1,this.setupPreference();var t=this.world.players;return t[0].isHuman=!0,t[1].isHuman=!0,t[2].isHuman=!0,t[3].isHuman=!0,t[0].activate(),t[1].deactive(),t[2].activate(),t[3].deactive(),t[0].luckyLevel=ddt.LuckyLevel.Best,e},test4AIPlayers:function(){var e=new i,t=this.world.players;return t[0].isHuman=!1,t[1].isHuman=!1,t[2].isHuman=!1,t[3].isHuman=!1,t[0].activate(),t[1].activate(),t[2].activate(),t[3].activate(),e},testAIwithHorseAtTower:function(){var e=new i;this.world.turnFirst=3;var t=this.world.players;ddt.userData.autoDice=!1,t[0].isHuman=!1,t[1].isHuman=!1,t[2].isHuman=!1,t[3].isHuman=!1,t[0].activate(),t[1].deactive(),t[2].activate(),t[3].activate();var n=t[0],o=n.horses;return o[1].setCurrentPlace(n.out,!0),o[3].setCurrentPlace(n.tower[5],!0),o[0].setCurrentPlace(this.world.roadMap[16],!0),o[2].setCurrentPlace(this.world.roadMap[20],!0),(o=(n=t[3]).horses)[0].setCurrentPlace(this.world.roadMap[4],!0),e},testWinCondition:function(){var e=new i,t=e.players;t[0].type=ddt.PlayerType.Human,t[1].type=ddt.PlayerType.AI,t[2].type=ddt.PlayerType.AI,t[3].type=ddt.PlayerType.Human,t[0].active=!0,t[1].active=!1,t[2].active=!1,t[3].active=!0;var n=t[0].horses,o=5;for(var r in n){var a=n[r];a.index=o,o--,a.placeType=ddt.PlaceType.Fame}return e},testFamePosition:function(){var e=new i;for(var t in this.world.players){var n=this.world.players[t];n.activate();var o=n.horses;o[0].setCurrentPlace(n.tower[5],!0),o[2].setCurrentPlace(n.tower[3],!0),o[3].setCurrentPlace(n.tower[4],!0),o[1].setCurrentPlace(n.tower[2],!0)}return this.world.updateHorseState(),this.world.fsm.popState(),e}});t.exports=o,cc._RF.pop()},{Config:"Config",WorldStateFactory:"WorldStateFactory"}],Types:[function(e,t){"use strict";cc._RF.push(t,"f4c05rVpHRK1pU8IEAkUWw4","Types");var n=cc.Enum({Classic:-1,Beach:-1,Forest:-1,Street:-1,Mars:-1}),i=cc.Enum({Red:-1,Yellow:-1,Green:-1,Blue:-1}),o=cc.Enum({Stable:-1,Point:-1,In:-1,Out:-1,Fame:-1}),r=cc.Enum({Human:-1,AI:-1}),a=cc.Enum({Worse:-1,Bad:-1,Normal:-1,Good:-1,Best:-1}),s=cc.Enum({TopFame:-1,OnFame:-1,Kick:-1,BeKick:-1,StartJourney:-1,EndJourney:-1,OnJourney:-1,Dispointed:-1,Danger:-1,Fighter:-1,Stable:-1});t.exports={AssetStyle:n,PlayerID:i,PlaceType:o,PlayerType:r,LuckyLevel:a,HorseState:s},cc._RF.pop()},{}],UltilityBar:[function(e,t){"use strict";cc._RF.push(t,"6162anhReVBkZOcW7LQWxXs","UltilityBar"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){},voteBtnPressed:function(){},fbBtnPressed:function(){},bannerBtnPressed:function(){cc.sys.openURL("https://apps.apple.com/app/id1396946650")}}),cc._RF.pop()},{}],UserData:[function(e,t){"use strict";cc._RF.push(t,"3ab52GzicZMAohKT7HzIeMk","UserData");var n=new(cc.Class({properties:{_autoDice:!1,autoDice:{get:function(){return this._autoDice=cc.sys.localStorage.getItem("auto-dice"),this._autoDice=null!=this._autoDice&&""!=this._autoDice&&this._autoDice,this._autoDice}},_autoMove:!1,autoMove:{get:function(){return this._autoMove=cc.sys.localStorage.getItem("auto-move"),this._autoMove=null!=this._autoMove&&""!=this._autoMove&&this._autoMove,this._autoMove}},sound:!0,backgroundType:"",tableSkin:"",soundType:"",horseSkins:{default:{}},_wins:0,wins:{get:function(){return this._wins},set:function(e){this._wins=e,cc.sys.localStorage.setItem("wins",e)}},_kicks:0,kicks:{get:function(){return this._kicks},set:function(e){this._kicks=e,cc.sys.localStorage.setItem("wins",e)}},_life:0,life:{get:function(){return this._life},set:function(e){this._life=e,cc.sys.localStorage.setItem("life",e)}}},load:function(){cc.log("UserData init...");var e=cc.sys.localStorage;this.sound=e.getItem("sound"),this._wins=e.getItem("wins"),this._kicks=e.getItem("kicks"),this._life=e.getItem("life"),this.sound=null==this.sound||""==this.sound||this.sound,this._wins=null==this._wins||""==this._wins?0:this._wins,this._kicks=null==this._kicks||""==this._kicks?0:this._kicks,this._life=null==this._life||""==this._life?10:parseInt(this._life),this.loadSkin(),this.soundType=ddt.asset.skin_classic},saveGame:function(e){var t={};for(var n in t.background=this.backgroundType,t.table=this.tableSkin,t.soundType=this.soundType,t.soundEnable=this.sound,t.dices=1,t.turn=e.currentPlayer.id,t.players=[],e.players){var i=e.players[n],o={};for(var r in o.id=i.id,o.type=i.isHuman?ddt.PlayerType.Human:ddt.PlayerType.AI,o.active=i.isActive(),o.horseSkin=this.horseSkins[ddt.asset.getHorseAsset(i.id)],o.horses=[],i.horses){var a=i.horses[r],s={};s.areaType=a.currentPlace.areaType,s.placeType=a.currentPlace.placeType;var c,l=a.currentPlace.placeType;c=l==ddt.PlaceType.Fame?i.tower.indexOf(a.currentPlace):l==ddt.PlaceType.Stable?i.stablePlaces.indexOf(a.currentPlace):e.roadMap.indexOf(a.currentPlace),s.index=c,s.locationX=a.currentPlace.location.x,s.locationY=a.currentPlace.location.y,o.horses.push(s)}t.players.push(o)}ddt.fileHelper.saveGameData(t,"saved_game")},loadSavedGame:function(e){var t=ddt.fileHelper.getData("saved_game");null==t&&e(!1),e(!0,JSON.parse(t))},clearSavedGame:function(){ddt.fileHelper.removeData("saved_game")},hasSavedGame:function(){return ddt.fileHelper.isFileExist("saved_game")},saveAutoDice:function(e){cc.sys.localStorage.setItem("auto-dice",e)},saveAutoMove:function(e){cc.sys.localStorage.setItem("auto-move",e)},saveSound:function(e){this.sound=e,cc.sys.localStorage.setItem("sound",e)},saveSkin:function(){var e={};e.tableSkin=this.tableSkin,e.backgroundType=this.backgroundType,e.redSkin=this.horseSkins[ddt.asset.horse_red],e.yellowSkin=this.horseSkins[ddt.asset.horse_yellow],e.greenSkin=this.horseSkins[ddt.asset.horse_green],e.blueSkin=this.horseSkins[ddt.asset.horse_blue],e.soundType=this.soundType,ddt.fileHelper.saveGameData(e,"skin_file")},loadSkin:function(){var e=ddt.fileHelper.getData("skin_file");if(e){var t=JSON.parse(e);this.tableSkin=t.tableSkin,this.backgroundType=t.backgroundType,this.horseSkins[ddt.asset.horse_red]=t.redSkin,this.horseSkins[ddt.asset.horse_yellow]=t.yellowSkin,this.horseSkins[ddt.asset.horse_green]=t.greenSkin,this.horseSkins[ddt.asset.horse_blue]=t.blueSkin,this.soundType=t.soundType}else this.loadDefaultSkin()},loadDefaultSkin:function(){this.tableSkin=ddt.asset.table_classic,this.backgroundType=ddt.asset.background_classic,this.horseSkins[ddt.asset.horse_red]=ddt.asset.skin_classic,this.horseSkins[ddt.asset.horse_yellow]=ddt.asset.skin_classic,this.horseSkins[ddt.asset.horse_green]=ddt.asset.skin_classic,this.horseSkins[ddt.asset.horse_blue]=ddt.asset.skin_classic,this.soundType=ddt.asset.skin_classic}}));t.exports=n,cc._RF.pop()},{}],VictoryPopup:[function(e,t){"use strict";cc._RF.push(t,"cc33dlhcV9F7LdvZYNsk9lv","VictoryPopup");var n=e("NetworkManager");cc.Class({extends:cc.Component,properties:{winSprite:cc.SpriteFrame,loseSprite:cc.SpriteFrame,title:cc.Sprite,worldNode:cc.Node,playersNode:cc.Node,indexsNode:cc.Node,homeBtn:cc.Node,popupNode:cc.Node,_world:null,_crowns:[],_scores:[],_players:[],_indexs:[]},onLoad:function(){this.node.active=!1,this.homeBtn.on("click",this.onHomeBtnClick,this),this._world=this.worldNode.getComponent("World"),this._players=this.playersNode.children,this._indexs=this.indexsNode.children,this._scores=this._players.map(function(e){return e.getComponentInChildren(cc.Label)}),this._crowns=this._players.map(function(e){return e.getComponentsInChildren(cc.Sprite)[1].node})},onEnable:function(){var e=this,t=[cc.v2(0,243),cc.v2(0,70),cc.v2(0,-98),cc.v2(0,-270)],i=this._world.currentPlayer.id==ddt.humanId,o=ddt.stepsTotal.filter(function(e){return e>0}).length,r=100+20*o;this.title.spriteFrame=i?this.winSprite:this.loseSprite;var a=ddt.stepsTotal.map(function(t,n){var i=10*(r-t);return n!=e._world.currentPlayer.id&&(i-=200),i<100&&(i=100),n==e._world.currentPlayer.id&&(i+=200),0==t&&(i=0),{score:i,playerId:n}}).sort(function(e,t){return t.score-e.score});if(a.forEach(function(n,i){e._players[n.playerId].position=t[i],e._players[n.playerId].active=n.score>0,e._indexs[i].active=i<o,e._crowns[n.playerId].active=0==i,e._scores[n.playerId].string=n.score}),ddt.isComputer){var s=a.find(function(e){return e.playerId==ddt.humanId}).score;n.NetworkManager.callEndGameAPI({score:s,gameLevel:null,star:null})}this.onShow()},onHomeBtnClick:function(){this.onHide(function(){return cc.director.loadScene("menu")})},onShow:function(){this.popupNode.scale=.1,cc.tween(this.popupNode).to(.2,{scale:1}).start()},onHide:function(e){var t=this;this.popupNode.scale=1,cc.tween(this.popupNode).to(.2,{scale:.1}).call(function(){return t.node.active=!1}).call(e).start()}}),cc._RF.pop()},{NetworkManager:"NetworkManager"}],WorldStateFactory:[function(e,t){"use strict";cc._RF.push(t,"beac23LrStEDLPARSi1TkQi","WorldStateFactory");var n=e("WorldState"),i=cc.Class({name:"WorldStateFactory",init:function(e){this.world=e},createTurnState:function(){return new n.TurnState},createDiceState:function(){return this.world.currentPlayer.isHuman?new n.DiceState:new n.AIDiceState},createMoveState:function(){return this.world.currentPlayer.isHuman?new n.MoveState:new n.AIMoveState},createDiceMoveToRestingState:function(){return new n.DiceMoveToRestingState}}),o=cc.Class({extends:i,init:function(e){this.baseFactory=e},createTurnState:function(){return this.baseFactory.createTurnState()},createDiceState:function(){return this.baseFactory.createDiceState()},createMoveState:function(){return this.baseFactory.createMoveState()}}),r=cc.Class({extends:o,createDiceState:function(){var e=this.baseFactory.createDiceState(),t=new n.AutoDiceState;return t.wrap(e),t}}),a=cc.Class({extends:o,createMoveState:function(){var e=this.baseFactory.createMoveState(),t=new n.AutoMoveState;return t.wrap(e),t}});t.exports={WorldStateFactory:i,AutoDiceWorldStateFactory:r,AutoMoveWorldStateFactory:a},cc._RF.pop()},{WorldState:"WorldState"}],WorldState:[function(e,t){"use strict";cc._RF.push(t,"518a0sKbwtJeIzNz3rkPbEB","WorldState");var n=cc.Class({ctor:function(){},init:function(){this.fire=!1,this.running=!0,this.transition=!1,this.description=""},pause:function(){this.running=!1},resume:function(){this.running=!0},onEnter:function(){},setRoll:function(){},handleInputs:function(){},update:function(){},lateUpdate:function(){},onExit:function(){},changeState:function(e,t){e.changeState(t)},isRunning:function(){return this.running},cleanup:function(){this.running=!1}}),i=cc.Class({extends:n,wrap:function(e){this.state=e,this.state.init(),this.description=this.state.description},onEnter:function(e){this.state.onEnter(e)},handleInputs:function(e,t){this.state.handleInputs(e,t)},update:function(e,t){this.state.update(e,t)},lateUpdate:function(e,t){this.state.lateUpdate(e,t)},onExit:function(e){this.state.onExit(e)}}),o=cc.Class({extends:n,ctor:function(){},init:function(){this._super(),this.description="TurnState"},update:function(e){var t=e.players;if(null==e.currentPlayer){if((a=t[e.turnFirst]).isActive())return e.currentPlayer=a,void(this.transition=!0);var n=0;for(n in t)if((a=t[n]).isActive()){e.currentPlayer=a,this.transition=!0;break}}else{if(e.gameRule.checkWin(e.currentPlayer))return cc.log("Game End! Player win: "+e.currentPlayer.horseAsset),e.node.emit(ddt.event.local_world_win),void e.fsm.schedule(function(){e.end()},2);var i=e.currentPlayer.getDiceFaceNumber();if(e.gameRule.isMoreTurn(i))return void(this.transition=!0);e.currentPlayer.hideDice();var o,r=t.indexOf(e.currentPlayer);if(r<t.length-1)for(o=r+1;o<t.length;o++)if((a=t[o]).isActive())return e.currentPlayer=a,void(this.transition=!0);if(r>0)for(o=0;o<r;o++){var a;if((a=t[o]).isActive())return e.currentPlayer=a,void(this.transition=!0)}}},lateUpdate:function(e){if(this.transition)return cc.log("Next turn for player with id: "+e.currentPlayer.id),e.updateHorseState(),e.currentPlayer.showDice(),void e.fsm.changeState(e.stateFactory.createDiceState())}}),r=cc.Class({extends:n,ctor:function(){},init:function(){this._super(),this.description="DiceState",this.playerRequireRoll=!1,this.diceStep=.2,this.duration=1.4,this.time=0,this.step=0,this.stepCounter=1},onEnter:function(e){e.currentPlayer.moveDiceToRolling(0)},setRoll:function(){this.playerRequireRoll=!0,world.currentPlayer.roller.roll()},handleInputs:function(e){!this.playerRequireRoll&&e.touchPoint&&e.currentPlayer.diceTouchArea.contains(e.touchPoint)&&(this.playerRequireRoll=!0,e.currentPlayer.roller.roll()),e.touchPoint=null},update:function(e,t){if(this.playerRequireRoll){var n=this.diceStep;this.step>n&&(this.step=0,this.stepCounter++,7==this.stepCounter?(e.currentPlayer.showFaceDiceResult(),this.transition=!0,cc.log("Player: "+e.currentPlayer.horseAsset+" roll a dice: "+e.currentPlayer.roller.getTotalStep())):e.currentPlayer.changeFaceDice(),e.node.emit(ddt.event.local_world_dicing)),this.step+=t}},lateUpdate:function(e){if(this.transition){var t=e.currentPlayer,n=(t.getDiceFaceNumber(),t.horses);for(var i in t.suggestMoves=[],n){var o=n[i],r=e.gameRule.findPath(t,o);if(r){var a={horse:o,path:r};t.suggestMoves.push(a)}}for(var s in t.suggestMoves)a=t.suggestMoves[s],cc.log("Horse with id: "+a.horse.id+" at current place: "+a.horse.currentPlace.placeType);e.updateHorseState(),t.suggestMoves.length>0?(t.isHuman&&e.node.emit(ddt.event.local_world_good_rolling),e.fsm.schedule(function(){e.currentPlayer.moveDiceToRecting(.3/e.speed,function(){}),e.fsm.schedule(function(){e.fsm.changeState(e.stateFactory.createMoveState())},.5)},1.5)):(t.isHuman&&e.node.emit(ddt.event.local_world_no_move),e.fsm.schedule(function(){t.resetDices(),e.fsm.changeState(e.stateFactory.createTurnState())},1.5))}},getAffectHorses:function(e){var t=[],n=e.currentPlayer;for(var i in n.suggestMoves){var o=n.suggestMoves[i];t.push(o.horse)}return t}}),a=cc.Class({extends:r,handleInputs:function(e){this.playerRequireRoll||(this.playerRequireRoll=!0,e.currentPlayer.roller.roll())}}),s=cc.Class({extends:i,init:function(){this._super(),this.description="DiceState"},handleInputs:function(e){this.state.playerRequireRoll||(this.state.playerRequireRoll=!0,e.currentPlayer.roller.roll())}}),c=cc.Class({extends:n,ctor:function(){},init:function(){this._super(),this.description="MoveState",this.moveableHorses=null,this.currentHorse=null,this.moves=[],this.time=0,this.duration=.2,this.hideMovableIndicator=!1},onEnter:function(e){var t=e.currentPlayer;for(var n in t.suggestMoves)t.suggestMoves[n].horse.showMovable()},handleInputs:function(e){var t=e.currentPlayer;if(null==this.currentHorse&&e.touchPoint)if(t.horses,t.diceTouchArea.contains(e.touchPoint))for(var n in t.suggestMoves){var i=t.suggestMoves[n];if(cc.log("Placetype of horse with id: "+i.horse.id+" is: "+i.horse.currentPlace.placeType),i.horse.currentPlace.placeType==ddt.PlaceType.Stable){this.currentHorse=i.horse,this.moves=i.path,cc.log("A horse export at start place: "+t.in.location);break}}else for(var o in t.suggestMoves)if((i=t.suggestMoves[o]).horse.getRect().contains(e.touchPoint)){this.currentHorse=i.horse,this.moves=i.path,cc.log("Chosen a horse and move to target place");break}e.touchPoint=null},update:function(e,t){if(!this.transition){var n=this.currentHorse;if(n){var i=e.currentPlayer;if(!this.hideMovableIndicator)for(var o in this.hideMovableIndicator=!0,i.horses)i.horses[o].showMovable(!1);if(0==this.moves.length&&(n.currentPlace.horse=n,n.currentPlace.placeType==ddt.PlaceType.Fame&&e.node.emit(ddt.event.local_world_promotion),this.transition=!0,cc.log("Done moved"),ddt.stepsTotal[i.id]++,ddt.horseNodes.map(function(e){return{y:e.position.y,horse:e}}).sort(function(e,t){return t.y-e.y}).forEach(function(e,t){return e.horse.setSiblingIndex(t)})),this.time>this.duration){this.time=0,n.currentPlace.horse=null,n.setCurrentPlace(this.moves.shift()),e.node.emit(ddt.event.local_world_horse_move);var r=n.currentPlace.horse;r&&(cc.log("Kick a horse of an enemy player"),e.scheduleOnce(function(){e.node.emit(ddt.event.local_world_kick)},.2),n.animation.play("horse-kicking"),r.animation.play("horse-be-kicked"),e.fsm.schedule(function(){r.returnStable()},2*e.speed)),e.node.emit(ddt.event.local_world_reoder)}this.time+=t}}},lateUpdate:function(e){if(this.transition)return e.node.emit(ddt.event.local_world_reoder),e.updateHorseState(),void e.fsm.changeState(e.stateFactory.createTurnState())}}),l=cc.Class({extends:c,init:function(){this._super(),cc.log("AIMoveState init...")},onEnter:function(){},handleInputs:function(e){if(null==this.currentHorse){var t=e.currentPlayer;if(1==t.suggestMoves.length)this.currentHorse=t.suggestMoves[0].horse,this.moves=t.suggestMoves[0].path;else{var n=t.node.getComponent("AIMove").makeDecision(e,t);this.currentHorse=n.horse,this.moves=n.path}}}}),d=cc.Class({extends:i,init:function(){this._super(),this.description="MoveState",this.movableHorses=null,this.checkedOnlyHorse=!1},handleInputs:function(e,t){if(!this.checkedOnlyHorse){this.checkedOnlyHorse=!0;var n=e.currentPlayer,i=!0;for(var o in n.suggestMoves)if((r=n.suggestMoves[o]).horse.currentPlace.placeType!=ddt.PlaceType.Stable){i=!1;break}if(i||1==n.suggestMoves.length){var r=n.suggestMoves[0];return this.state.currentHorse=r.horse,this.state.moves=r.path,void(r.horse.currentPlace==r.horse.stablePlace&&(r.horse.currentPlace.horse=null,e.node.emit(ddt.event.local_world_export_horse)))}}this._super(e,t)}});t.exports={TurnState:o,DiceState:r,AIDiceState:a,AutoDiceState:s,MoveState:c,AIMoveState:l,AutoMoveState:d},cc._RF.pop()},{}],World:[function(e,t){"use strict";cc._RF.push(t,"4ae1fI9W7dMn4DsV8uhMMNr","World");var n=e("Player"),i=(e("Horse"),e("PlaceHolder")),o=e("FSM"),r=(e("WorldState"),e("WorldStateFactory")),a=e("GameRule"),s=(e("Types").PlayerID,e("Types").PlaceType),c=cc.Class({extends:cc.Component,properties:{players:{default:[],type:[n]},roadMap:{default:[],type:i},backgroundNode:cc.Node,tableNode:cc.Node,speed:1,turnFirst:0,dice_z:100,horse_z:5,fsm:o,gameRule:a},statics:{},onLoad:function(){ddt.world=this,this.node.on(ddt.event.local_world_kick,this.onPlayerKickEnemyHorse,this),this.node.on(ddt.event.local_world_promotion,this.onHorsePromotion,this),this.node.on(ddt.event.local_world_horse_move,this.onHorseMoveStepByStep,this),this.node.on(ddt.event.local_world_export_horse,this.onPlayerExportHorse,this),this.node.on(ddt.event.local_world_good_rolling,this.onPlayerRollGoodDice,this)},init:function(){var e;for(e in this.touch=null,this.currentPlayer=null,this.fsm.init(this),this.speed=2,this.players)this.players[e].init(this);for(var t=this,n=function(n){for(e in t.players){var i=t.players[e];if(i.id==n.areaType){n.placeType==s.In?i.in=n:n.placeType==s.Out&&(i.out=n);break}}},i=this.roadMap.length,o=0;o<i-1;o++){var r=o+1,a=this.roadMap[o],c=this.roadMap[r];a.nextPlaceHoder=c,c.prevPlace=a}for(e in this.roadMap[i-1].nextPlaceHoder=this.roadMap[0],this.roadMap[0].prevPlace=this.roadMap[i-1],this.roadMap){var l=this.roadMap[e];l.index=e,l.placeType!=s.In&&l.placeType!=s.Out||n(l)}},prepare:function(e){for(var t in this.players){var n=this.players[t],i=e.players[t];i.active?(n.prepare(i),n.activate()):n.deactive()}if(e.playerTurn>-1)for(var t in this.players)if((n=this.players[t]).id==e.playerTurn){this.currentPlayer=n;break}for(var t in this.currentPlayer=null,this.touchPoint=null,this.roadMap)this.roadMap[t].horse=null;var o=new r.WorldStateFactory;if(o.init(this),e.autoDice){var a=new r.AutoDiceWorldStateFactory;a.init(o),o=a}if(e.autoMove){var s=new r.AutoMoveWorldStateFactory;s.init(o),o=s}this.stateFactory=o,this.node.parent.active=!0,this.node.emit(ddt.event.local_world_reoder)},reskin:function(){for(var e in this.players)this.players[e].reskin()},getTargetPlace:function(e,t){for(var n=0,i=e;n<t;)i=i.nextPlaceHoder,n++;return i},play:function(){this.node.parent.active=!0,this.node.emit(ddt.event.local_world_reoder),this.fsm.changeState(this.stateFactory.createTurnState()),this.fsm.start(),console.log("really started game")},end:function(){var e;if(this.fsm.quit(),this.currentPlayer.isHuman){var t=+ddt.userData.wins+1;ddt.userData.wins=t}this.node.parent.active=!1,null==(e=this.node.parent.parent.parent.getComponent("GamePlay"))||e.showGameEnd()},isEnd:function(){return this.fsm.end},update:function(e){if(this.fsm.isRunning()){var t=e*this.speed;this.fsm.loop(t)}},isRunning:function(){return this.fsm.isRunning()},onDestroy:function(){cc.log("The World destroyed."),ddt.world=null},onPlayerKickEnemyHorse:function(){if(this.currentPlayer&&this.currentPlayer.isHuman){var e=+ddt.userData.kicks+1;ddt.userData.kicks=e}},onPlayerExportHorse:function(){},onPlayerRollGoodDice:function(){},onHorseMoveStepByStep:function(){},onHorsePromotion:function(){},updateHorseState:function(){for(var e in cc.log("Need update horse state..."),this.players){var t=this.players[e];if(t.isActive())for(var n in t.horses)t.horses[n].updateState(this)}}});c.dice_z=100,c.horse_z=2,cc._RF.pop()},{FSM:"FSM",GameRule:"GameRule",Horse:"Horse",PlaceHolder:"PlaceHolder",Player:"Player",Types:"Types",WorldState:"WorldState",WorldStateFactory:"WorldStateFactory"}],en:[function(e,t){"use strict";cc._RF.push(t,"f09c135DcdA4qMZs/pHokFj","en"),t.exports={label_player:"Player",label_ai:"AI",label_other_setting:"Other Setting",label_auto_dicing:"Automatic Dice",label_auto_move:"Automatic Move",label_statis_title_dialog:"Statistic",label_statis_title_win:"Games you won :",label_statis_title_kick:"Horses your team kicked :",label_shop_title_table:"Default Board",label_shop_title_sound:"Default Music",label_dialog_title_warn:"Info",label_lang:"Language",sound_on:"Sound: ON",sound_off:"Sound: OFF",warn_no_human:"There must be at least one human player.",warn_not_enough_players:"There must be at least 2 teams in a game.",team_red_name:"Red Team",team_yellow_name:"Yellow Team",team_green_name:"Green Team",team_blue_name:"Blue Team",congratulates_winner:function(e){return"Congratulations!\n"+e+" win"},game:"cocanguaadx",admob_interstitial_id_android:"/194427432/AdSoft/cocangua2inter",admob_banner_id_android:"/194427432/AdSoft/cocangua2banner",admob_interstitial_id_ios:"ca-mb-app-pub-4294239739045241/1267448575/3897337015",admob_banner_id_ios:"ca-mb-app-pub-4294239739045241/1267448575/5374044895"},cc._RF.pop()},{}],oldData:[function(e,t){"use strict";cc._RF.push(t,"5b1839YKy1Aw56KiJ/vEjIm","oldData"),cc.Class({extends:cc.Component,properties:{},start:function(){}}),cc._RF.pop()},{}],roadMapData:[function(e,t){"use strict";cc._RF.push(t,"9bfc2BpK8pLRawB4XpKA88s","roadMapData"),t.exports=[{index:0,location:{x:440,y:990,z:0},placeType:2,areaType:0,view:-1},{index:1,location:{x:440,y:923.8,z:0},placeType:1,areaType:0,view:-1},{index:2,location:{x:440,y:858,z:0},placeType:1,areaType:0,view:-1},{index:3,location:{x:440,y:794,z:0},placeType:1,areaType:0,view:-1},{index:4,location:{x:440,y:728,z:0},placeType:1,areaType:0,view:-1},{index:5,location:{x:440,y:663,z:0},placeType:1,areaType:0,view:-1},{index:6,location:{x:373.8,y:600,z:0},placeType:1,areaType:0,view:-1},{index:7,location:{x:310,y:600,z:0},placeType:1,areaType:0,view:1},{index:8,location:{x:244,y:600,z:0},placeType:1,areaType:0,view:1},{index:9,location:{x:180,y:600,z:0},placeType:1,areaType:0,view:1},{index:10,location:{x:124,y:600,z:0},placeType:1,areaType:0,view:1},{index:11,location:{x:43,y:600,z:0},placeType:1,areaType:0,view:1},{index:12,location:{x:48,y:531,z:0},placeType:3,areaType:1,view:1},{index:13,location:{x:48,y:467,z:0},placeType:2,areaType:1,view:-1},{index:14,location:{x:114,y:470,z:0},placeType:1,areaType:1,view:-1},{index:15,location:{x:179,y:470,z:0},placeType:1,areaType:1,view:-1},{index:16,location:{x:244,y:470,z:0},placeType:1,areaType:1,view:-1},{index:17,location:{x:309,y:470,z:0},placeType:1,areaType:1,view:-1},{index:18,location:{x:374,y:470,z:0},placeType:1,areaType:1,view:-1},{index:19,location:{x:439,y:401,z:0},placeType:1,areaType:1,view:-1},{index:20,location:{x:439,y:337,z:0},placeType:1,areaType:1,view:-1},{index:21,location:{x:439,y:271,z:0},placeType:1,areaType:1,view:-1},{index:22,location:{x:439,y:206,z:0},placeType:1,areaType:1,view:-1},{index:23,location:{x:439,y:141,z:0},placeType:1,areaType:1,view:-1},{index:24,location:{x:439,y:75,z:0},placeType:1,areaType:1,view:-1},{index:25,location:{x:505,y:76,z:0},placeType:3,areaType:2,view:-1},{index:26,location:{x:569,y:76,z:0},placeType:2,areaType:2,view:-1},{index:27,location:{x:569,y:139,z:0},placeType:1,areaType:2,view:-1},{index:28,location:{x:569,y:208,z:0},placeType:1,areaType:2,view:1},{index:29,location:{x:569,y:272,z:0},placeType:1,areaType:2,view:1},{index:30,location:{x:569,y:337,z:0},placeType:1,areaType:2,view:1},{index:31,location:{x:569,y:401,z:0},placeType:1,areaType:2,view:1},{index:32,location:{x:535,y:467,z:0},placeType:1,areaType:2,view:1},{index:33,location:{x:700,y:467,z:0},placeType:1,areaType:2,view:1},{index:34,location:{x:766,y:467,z:0},placeType:1,areaType:2,view:-1},{index:35,location:{x:830,y:467,z:0},placeType:1,areaType:2,view:-1},{index:36,location:{x:896,y:467,z:0},placeType:1,areaType:2,view:-1},{index:37,location:{x:960,y:467,z:0},placeType:1,areaType:2,view:-1},{index:38,location:{x:960.2,y:531,z:0},placeType:3,areaType:3,view:-1},{index:39,location:{x:960,y:596,z:0},placeType:2,areaType:3,view:-1},{index:40,location:{x:895,y:596,z:0},placeType:1,areaType:3,view:-1},{index:41,location:{x:831,y:596,z:0},placeType:1,areaType:3,view:1},{index:42,location:{x:765,y:596,z:0},placeType:1,areaType:3,view:1},{index:43,location:{x:700,y:596,z:0},placeType:1,areaType:3,view:1},{index:44,location:{x:635,y:596,z:0},placeType:1,areaType:3,view:1},{index:45,location:{x:569,y:662,z:0},placeType:1,areaType:3,view:1},{index:46,location:{x:569,y:728,z:0},placeType:1,areaType:3,view:1},{index:47,location:{x:569,y:793,z:0},placeType:1,areaType:3,view:1},{index:48,location:{x:569,y:858,z:0},placeType:1,areaType:3,view:1},{index:49,location:{x:569,y:922,z:0},placeType:1,areaType:3,view:1},{index:50,location:{x:569,y:988,z:0},placeType:1,areaType:3,view:1},{index:51,location:{x:503,y:988,z:0},placeType:3,areaType:0,view:1}],cc._RF.pop()},{}],use_reversed_rotateBy:[function(e,t){"use strict";cc._RF.push(t,"6167ep21gdEi5n0Vk9NKitE","use_reversed_rotateBy"),cc.RotateBy._reverse=!0,cc._RF.pop()},{}],"use_v2.0.x_cc.Toggle_event":[function(e,t){"use strict";cc._RF.push(t,"0fcb0f+cFpISr3EdZ9/2AJT","use_v2.0.x_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_check=!0),cc._RF.pop()},{}],vi:[function(e,t){"use strict";cc._RF.push(t,"10824hx4zVE8r7bEK4O2CnS","vi"),t.exports={label_player:"Ng\u01b0\u1eddi ch\u01a1i",label_ai:"M\xe1y ch\u01a1i",label_other_setting:"C\xe0i \u0111\u1eb7t kh\xe1c",label_auto_dicing:"Gieo x\xfac x\u1eafc t\u1ef1 \u0111\u1ed9ng",label_auto_move:"T\u1ef1 \u0111\u1ed9ng \u0111i ng\u1ef1a duy nh\u1ea5t",label_statis_title_dialog:"Th\u1ed1ng k\xea",label_statis_title_win:"S\u1ed1 v\xe1n th\u1eafng :",label_statis_title_kick:"S\u1ed1 ng\u1ef1a \u0111\xe1 \u0111\u01b0\u1ee3c :",label_shop_title_table:"B\xe0n ch\u01a1i m\u1eb7c \u0111\u1ecbnh",label_shop_title_sound:"\xc2m thanh m\u1eb7c \u0111\u1ecbnh",label_dialog_title_warn:"Th\xf4ng b\xe1o",label_lang:"Ng\xf4n ng\u1eef",sound_on:"\xc2m thanh: B\u1eacT",sound_off:"\xc2m thanh: T\u1eaeT",warn_no_human:"Ph\u1ea3i c\xf3 \xedt nh\u1ea5t m\u1ed9t ng\u01b0\u1eddi ch\u01a1i.",warn_not_enough_players:"Ph\u1ea3i c\xf3 \xedt nh\u1ea5t 2 \u0111\u1ed9i.",team_red_name:"Ng\u1ef1a \u0111\u1ecf",team_yellow_name:"Ng\u1ef1a v\xe0ng",team_green_name:"Ng\u1ef1a xanh l\xe1 c\xe2y",team_blue_name:"Ng\u1ef1a xanh bi\u1ec3n",congratulates_winner:function(e){return"Ch\xfac m\u1eebng!\n"+e+" d\xe0nh chi\u1ebfn th\u1eafng"},game:"cocanguaadx",admob_interstitial_id_android:"/194427432/AdSoft/cocangua2inter",admob_banner_id_android:"/194427432/AdSoft/cocangua2banner",admob_interstitial_id_ios:"ca-mb-app-pub-4294239739045241/1267448575/3897337015",admob_banner_id_ios:"ca-mb-app-pub-4294239739045241/1267448575/5374044895"},cc._RF.pop()},{}]},{},["ItemShop","ShopUI2","FadeTransition","PanelTransition","AnimHelper","Asset","AssetHelper","Event","FileHelper","Global","Types","UltilityBar","UserData","AudioSource","SmartButton","Config","EndLayer","GamePlay","NetworkManager","PauseLayer","PausePopup","ShopLayer","TestPlay","VictoryPopup","AIMove","Dice","FSM","GameRule","Horse","HorseSound","HorseState","PlaceHolder","Player","RenderOrder","Roller","SoundEffect","World","WorldState","WorldStateFactory","oldData","roadMapData","HorseSkin","HorseSkinSelection","SoundType","SoundTypeSelection","TableSkin","TableSkinSelection","MenuSidebar","StatisContent","TabCtrl","HorseSelection","Init","LoadingScreen","Menu","NewGame","NotTurnPopup","PlayModeDia","SelectComputerScreen","SelectLocalScreen","SelectPositionScreen","Splash","Lang","en","vi","use_reversed_rotateBy","use_v2.0.x_cc.Toggle_event"]);